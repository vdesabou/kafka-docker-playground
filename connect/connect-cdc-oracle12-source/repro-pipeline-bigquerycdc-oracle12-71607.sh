#!/bin/bash
set -e

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null && pwd )"
source ${DIR}/../../scripts/utils.sh

function wait_for_repro () {
     MAX_WAIT=600
     CUR_WAIT=0
     log "Waiting up to $MAX_WAIT seconds for error Multiple entries with same key to happen"
     docker container logs connect > /tmp/out.txt 2>&1
     while ! grep "Multiple entries with same key" /tmp/out.txt > /dev/null;
     do
          sleep 10
          docker container logs connect > /tmp/out.txt 2>&1
          CUR_WAIT=$(( CUR_WAIT+10 ))
          if [[ "$CUR_WAIT" -gt "$MAX_WAIT" ]]; then
               echo -e "\nERROR: The logs in all connect containers do not show 'Multiple entries with same key' after $MAX_WAIT seconds. Please troubleshoot with 'docker container ps' and 'docker container logs'.\n"
               exit 1
          fi
     done
     log "The problem has been reproduced !"
}

PROJECT=${1:-vincent-de-saboulin-lab}

KEYFILE="${DIR}/keyfile.json"
if [ ! -f ${KEYFILE} ]
then
     logerror "ERROR: the file ${KEYFILE} file is not present!"
     exit 1
fi

DATASET=pg${USER}ds${GITHUB_RUN_NUMBER}${TAG}
DATASET=${DATASET//[-._]/}

log "Doing gsutil authentication"
set +e
docker rm -f gcloud-config
set -e
docker run -i -v ${KEYFILE}:/tmp/keyfile.json --name gcloud-config google/cloud-sdk:latest gcloud auth activate-service-account --project ${PROJECT} --key-file /tmp/keyfile.json

set +e
log "Drop dataset $DATASET, this might fail"
docker run -i --volumes-from gcloud-config google/cloud-sdk:latest bq --project_id "$PROJECT" rm -r -f -d "$DATASET"
set -e

log "Create dataset $PROJECT.$DATASET"
docker run -i --volumes-from gcloud-config google/cloud-sdk:latest bq --project_id "$PROJECT" mk --dataset --description "used by playground" "$DATASET"


export ORACLE_IMAGE="oracle/database:12.2.0.1-ee"

if test -z "$(docker images -q $ORACLE_IMAGE)"
then
    if [ ! -z "$CI" ]
    then
        if [ ! -f ${DIR}/linuxx64_12201_database.zip ]
        then
            # running with github actions
            aws s3 cp --only-show-errors s3://kafka-docker-playground/3rdparty/linuxx64_12201_database.zip .
        fi
    fi
    if [ ! -f ${DIR}/linuxx64_12201_database.zip ]
    then
        logerror "ERROR: ${DIR}/linuxx64_12201_database.zip is missing. It must be downloaded manually in order to acknowledge user agreement"
        exit 1
    fi
    log "Building $ORACLE_IMAGE docker image..it can take a while...(more than 15 minutes!)"
    OLDDIR=$PWD
    rm -rf ${DIR}/docker-images
    git clone https://github.com/oracle/docker-images.git

    mv ${DIR}/linuxx64_12201_database.zip ${DIR}/docker-images/OracleDatabase/SingleInstance/dockerfiles/12.2.0.1/linuxx64_12201_database.zip
    cd ${DIR}/docker-images/OracleDatabase/SingleInstance/dockerfiles
    ./buildContainerImage.sh -v 12.2.0.1 -e
    rm -rf ${DIR}/docker-images
    cd ${OLDDIR}
fi

${DIR}/../../environment/plaintext/start.sh "${PWD}/docker-compose.plaintext.cdb-repro-pipeline-bigquery-71607.yml"


# Verify Oracle DB has started within MAX_WAIT seconds
MAX_WAIT=900
CUR_WAIT=0
log "Waiting up to $MAX_WAIT seconds for Oracle DB to start"
docker container logs oracle > /tmp/out.txt 2>&1
while [[ ! $(cat /tmp/out.txt) =~ "DONE: Executing user defined scripts" ]]; do
sleep 10
docker container logs oracle > /tmp/out.txt 2>&1
CUR_WAIT=$(( CUR_WAIT+10 ))
if [[ "$CUR_WAIT" -gt "$MAX_WAIT" ]]; then
     logerror "ERROR: The logs in oracle container do not show 'DONE: Executing user defined scripts' after $MAX_WAIT seconds. Please troubleshoot with 'docker container ps' and 'docker container logs'.\n"
     exit 1
fi
done
log "Oracle DB has started!"

# Create a redo-log-topic-json. Please make sure you create a topic with the same name you will use for "redo.log.topic.name": "redo-log-topic-json"
# CC-13104
docker exec connect kafka-topics --create --topic redo-log-topic-json --bootstrap-server broker:9092 --replication-factor 1 --partitions 1 --config cleanup.policy=delete --config retention.ms=120960000
log "redo-log-topic-json is created"
docker exec connect kafka-topics --create --topic redo-log-topic-avro --bootstrap-server broker:9092 --replication-factor 1 --partitions 1 --config cleanup.policy=delete --config retention.ms=120960000
log "redo-log-topic-avro is created"
sleep 5


log "Creating Oracle source connector with JSONConverter"
curl -X PUT \
     -H "Content-Type: application/json" \
     --data '{
               "connector.class": "io.confluent.connect.oracle.cdc.OracleCdcSourceConnector",
               "tasks.max":2,
               "value.converter": "org.apache.kafka.connect.json.JsonConverter",
               "key.converter": "org.apache.kafka.connect.json.JsonConverter",
               "key.template": "${primaryKeyStruct}",
               "confluent.license": "",
               "confluent.topic.bootstrap.servers": "broker:9092",
               "confluent.topic.replication.factor": "1",
               "oracle.server": "oracle",
               "oracle.port": 1521,
               "oracle.sid": "ORCLCDB",
               "oracle.username": "C##MYUSER",
               "oracle.password": "mypassword",
               "start.from":"snapshot",
               "redo.log.topic.name": "redo-log-topic-json",
               "redo.log.consumer.bootstrap.servers":"broker:9092",
               "table.inclusion.regex": ".*CUSTOMERS.*",
               "table.topic.name.template": "${databaseName}.${schemaName}.${tableName}.JSON",
               "numeric.mapping": "best_fit",
               "connection.pool.max.size": 20,
               "confluent.topic.replication.factor":1
          }' \
     http://localhost:8083/connectors/cdc-oracle-source-cdb-json/config | jq .

log "Creating Oracle source connector with AvroConverter"
curl -X PUT \
     -H "Content-Type: application/json" \
     --data '{
               "connector.class": "io.confluent.connect.oracle.cdc.OracleCdcSourceConnector",
               "tasks.max":2,
               "key.converter": "io.confluent.connect.avro.AvroConverter",
               "key.converter.schema.registry.url": "http://schema-registry:8081",
               "value.converter": "io.confluent.connect.avro.AvroConverter",
               "value.converter.schema.registry.url": "http://schema-registry:8081",
               "key.template": "${primaryKeyStruct}",
               "confluent.license": "",
               "confluent.topic.bootstrap.servers": "broker:9092",
               "confluent.topic.replication.factor": "1",
               "oracle.server": "oracle",
               "oracle.port": 1521,
               "oracle.sid": "ORCLCDB",
               "oracle.username": "C##MYUSER",
               "oracle.password": "mypassword",
               "start.from":"snapshot",
               "redo.log.topic.name": "redo-log-topic-avro",
               "redo.log.consumer.bootstrap.servers":"broker:9092",
               "table.inclusion.regex": ".*CUSTOMERS.*",
               "table.topic.name.template": "${databaseName}.${schemaName}.${tableName}.AVRO",
               "numeric.mapping": "best_fit",
               "connection.pool.max.size": 20,
               "confluent.topic.replication.factor":1
          }' \
     http://localhost:8083/connectors/cdc-oracle-source-cdb-avro/config | jq .

log "Waiting 60s for cdc-oracle-source-cdb-json and cdc-oracle-source-cdb-avro to read existing data"
sleep 60

log "Running SQL scripts"
for script in ${DIR}/sample-sql-scripts/*.sh
do
     $script "ORCLCDB"
done

log "Verifying topic ORCLCDB.C__MYUSER.CUSTOMERS.JSON: there should be 13 records"
set +e
timeout 60 docker exec connect kafka-console-consumer -bootstrap-server broker:9092 --topic ORCLCDB.C__MYUSER.CUSTOMERS.JSON --from-beginning --max-messages 13 > /tmp/result.log  2>&1
set -e
cat /tmp/result.log
log "Check there is 5 snapshots events"
if [ $(grep -c "op_type\":\"R\"" /tmp/result.log) -ne 5 ]
then
     logerror "Did not get expected results"
     exit 1
fi
log "Check there is 3 insert events"
if [ $(grep -c "op_type\":\"I\"" /tmp/result.log) -ne 3 ]
then
     logerror "Did not get expected results"
     exit 1
fi
log "Check there is 4 update events"
if [ $(grep -c "op_type\":\"U\"" /tmp/result.log) -ne 4 ]
then
     logerror "Did not get expected results"
     exit 1
fi
log "Check there is 1 delete events"
if [ $(grep -c "op_type\":\"D\"" /tmp/result.log) -ne 1 ]
then
     logerror "Did not get expected results"
     exit 1
fi

# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":1,"FIRST_NAME":"Rica","LAST_NAME":"Blaisdell","EMAIL":"rblaisdell0@rambler.ru","GENDER":"Female","CLUB_STATUS":"bronze","COMMENTS":"Universal optimal hierarchy","CREATE_TS":1631535970214,"UPDATE_TS":1631535970000,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445085","op_type":"R","op_ts":null,"current_ts":"1631536003507","row_id":null,"username":null}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":2,"FIRST_NAME":"Ruthie","LAST_NAME":"Brockherst","EMAIL":"rbrockherst1@ow.ly","GENDER":"Female","CLUB_STATUS":"platinum","COMMENTS":"Reverse-engineered tangible interface","CREATE_TS":1631535970219,"UPDATE_TS":1631535970000,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445085","op_type":"R","op_ts":null,"current_ts":"1631536003514","row_id":null,"username":null}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":3,"FIRST_NAME":"Mariejeanne","LAST_NAME":"Cocci","EMAIL":"mcocci2@techcrunch.com","GENDER":"Female","CLUB_STATUS":"bronze","COMMENTS":"Multi-tiered bandwidth-monitored capability","CREATE_TS":1631535970220,"UPDATE_TS":1631535970000,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445085","op_type":"R","op_ts":null,"current_ts":"1631536003515","row_id":null,"username":null}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":4,"FIRST_NAME":"Hashim","LAST_NAME":"Rumke","EMAIL":"hrumke3@sohu.com","GENDER":"Male","CLUB_STATUS":"platinum","COMMENTS":"Self-enabling 24/7 firmware","CREATE_TS":1631535970220,"UPDATE_TS":1631535970000,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445085","op_type":"R","op_ts":null,"current_ts":"1631536003515","row_id":null,"username":null}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":5,"FIRST_NAME":"Hansiain","LAST_NAME":"Coda","EMAIL":"hcoda4@senate.gov","GENDER":"Male","CLUB_STATUS":"platinum","COMMENTS":"Centralized full-range approach","CREATE_TS":1631535970221,"UPDATE_TS":1631535970000,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445085","op_type":"R","op_ts":null,"current_ts":"1631536003515","row_id":null,"username":null}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":42,"FIRST_NAME":"Frantz","LAST_NAME":"Kafka","EMAIL":"fkafka@confluent.io","GENDER":"Male","CLUB_STATUS":"bronze","COMMENTS":"Evil is whatever distracts","CREATE_TS":1631536048673,"UPDATE_TS":1631536048000,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445212","op_type":"I","op_ts":"1631536048000","current_ts":"1631536051453","row_id":"AAAR9TAAHAAAACHAAF","username":"C##MYUSER"}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":43,"FIRST_NAME":"Gregor","LAST_NAME":"Samsa","EMAIL":"gsamsa@confluent.io","GENDER":"Male","CLUB_STATUS":"platinium","COMMENTS":"How about if I sleep a little bit longer and forget all this nonsense","CREATE_TS":1631536048676,"UPDATE_TS":1631536048000,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445212","op_type":"I","op_ts":"1631536048000","current_ts":"1631536051458","row_id":"AAAR9TAAHAAAACHAAG","username":"C##MYUSER"}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":42,"FIRST_NAME":"Frantz","LAST_NAME":"Kafka","EMAIL":"fkafka@confluent.io","GENDER":"Male","CLUB_STATUS":"gold","COMMENTS":"Evil is whatever distracts","CREATE_TS":1631536048673,"UPDATE_TS":1631536049000,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445219","op_type":"U","op_ts":"1631536049000","current_ts":"1631536051467","row_id":"AAAR9TAAHAAAACHAAF","username":"C##MYUSER"}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":42,"FIRST_NAME":"Frantz","LAST_NAME":"Kafka","EMAIL":"fkafka@confluent.io","GENDER":"Male","CLUB_STATUS":"gold","COMMENTS":"Evil is whatever distracts","CREATE_TS":1631536048673,"UPDATE_TS":1631536049000,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445226","op_type":"D","op_ts":"1631536049000","current_ts":"1631536051472","row_id":"AAAR9TAAHAAAACHAAF","username":"C##MYUSER"}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"COUNTRY"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":44,"FIRST_NAME":"Josef","LAST_NAME":"K","EMAIL":"jk@confluent.io","GENDER":"Male","CLUB_STATUS":"bronze","COMMENTS":"How is it even possible for someone to be guilty","CREATE_TS":1631536050602,"UPDATE_TS":1631536050000,"COUNTRY":"Poland","table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445248","op_type":"I","op_ts":"1631536050000","current_ts":"1631536051480","row_id":"AAAR9TAAHAAAACHAAH","username":"C##MYUSER"}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"COUNTRY"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":43,"FIRST_NAME":"Gregor","LAST_NAME":"Samsa","EMAIL":"gsamsa@confluent.io","GENDER":"Male","CLUB_STATUS":"silver","COMMENTS":"How about if I sleep a little bit longer and forget all this nonsense","CREATE_TS":1631536048676,"UPDATE_TS":1631536050000,"COUNTRY":null,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445249","op_type":"U","op_ts":"1631536050000","current_ts":"1631536051484","row_id":"AAAR9TAAHAAAACHAAG","username":"C##MYUSER"}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"COUNTRY"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":43,"FIRST_NAME":"Gregor","LAST_NAME":"Samsa","EMAIL":"gsamsa@confluent.io","GENDER":"Male","CLUB_STATUS":"gold","COMMENTS":"How about if I sleep a little bit longer and forget all this nonsense","CREATE_TS":1631536048676,"UPDATE_TS":1631536051000,"COUNTRY":null,"table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445256","op_type":"U","op_ts":"1631536051000","current_ts":"1631536091411","row_id":"AAAR9TAAHAAAACHAAG","username":"C##MYUSER"}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":false,"field":"ID"},{"type":"string","optional":true,"field":"FIRST_NAME"},{"type":"string","optional":true,"field":"LAST_NAME"},{"type":"string","optional":true,"field":"EMAIL"},{"type":"string","optional":true,"field":"GENDER"},{"type":"string","optional":true,"field":"CLUB_STATUS"},{"type":"string","optional":true,"field":"COMMENTS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"CREATE_TS"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"UPDATE_TS"},{"type":"string","optional":true,"field":"COUNTRY"},{"type":"string","optional":true,"field":"table"},{"type":"string","optional":true,"field":"scn"},{"type":"string","optional":true,"field":"op_type"},{"type":"string","optional":true,"field":"op_ts"},{"type":"string","optional":true,"field":"current_ts"},{"type":"string","optional":true,"field":"row_id"},{"type":"string","optional":true,"field":"username"}],"optional":false},"payload":{"ID":44,"FIRST_NAME":"Josef","LAST_NAME":"K","EMAIL":"jk@confluent.io","GENDER":"Male","CLUB_STATUS":"gold","COMMENTS":"How is it even possible for someone to be guilty","CREATE_TS":1631536050602,"UPDATE_TS":1631536051000,"COUNTRY":"Poland","table":"ORCLCDB.C##MYUSER.CUSTOMERS","scn":"1445256","op_type":"U","op_ts":"1631536051000","current_ts":"1631536091414","row_id":"AAAR9TAAHAAAACHAAH","username":"C##MYUSER"}}
# Processed a total of 13 messages


log "Verifying topic redo-log-topic-json: there should be 9 records"
timeout 60 docker exec connect kafka-console-consumer -bootstrap-server broker:9092 --topic redo-log-topic-json --from-beginning --max-messages 9

# {"schema":{"type":"struct","fields":[{"type":"int64","optional":true,"field":"SCN"},{"type":"int64","optional":true,"field":"START_SCN"},{"type":"int64","optional":true,"field":"COMMIT_SCN"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"START_TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"COMMIT_TIMESTAMP"},{"type":"int64","optional":true,"field":"XIDUSN"},{"type":"int64","optional":true,"field":"XIDSLT"},{"type":"int64","optional":true,"field":"XIDSQN"},{"type":"bytes","optional":true,"field":"XID"},{"type":"int64","optional":true,"field":"PXIDUSN"},{"type":"int64","optional":true,"field":"PXIDSLT"},{"type":"int64","optional":true,"field":"PXIDSQN"},{"type":"bytes","optional":true,"field":"PXID"},{"type":"string","optional":true,"field":"TX_NAME"},{"type":"string","optional":true,"field":"OPERATION"},{"type":"int8","optional":true,"field":"OPERATION_CODE"},{"type":"boolean","optional":true,"field":"ROLLBACK"},{"type":"string","optional":true,"field":"SEG_OWNER"},{"type":"string","optional":true,"field":"SEG_NAME"},{"type":"string","optional":true,"field":"TABLE_NAME"},{"type":"int8","optional":true,"field":"SEG_TYPE"},{"type":"string","optional":true,"field":"SEG_TYPE_NAME"},{"type":"string","optional":true,"field":"TABLE_SPACE"},{"type":"string","optional":true,"field":"ROW_ID"},{"type":"string","optional":true,"field":"USERNAME"},{"type":"string","optional":true,"field":"OS_USERNAME"},{"type":"string","optional":true,"field":"MACHINE_NAME"},{"type":"int64","optional":true,"field":"AUDIT_SESSIONID"},{"type":"int64","optional":true,"field":"SESSION_NUM"},{"type":"int64","optional":true,"field":"SERIAL_NUM"},{"type":"string","optional":true,"field":"SESSION_INFO"},{"type":"int64","optional":true,"field":"THREAD_NUM"},{"type":"int64","optional":true,"field":"SEQUENCE_NUM"},{"type":"int64","optional":true,"field":"RBASQN"},{"type":"int64","optional":true,"field":"RBABLK"},{"type":"int64","optional":true,"field":"RBABYTE"},{"type":"int64","optional":true,"field":"UBAFIL"},{"type":"int64","optional":true,"field":"UBABLK"},{"type":"int64","optional":true,"field":"UBAREC"},{"type":"int64","optional":true,"field":"UBASQN"},{"type":"int64","optional":true,"field":"ABS_FILE_NUM"},{"type":"int64","optional":true,"field":"REL_FILE_NUM"},{"type":"int64","optional":true,"field":"DATA_BLK_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJ_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJV_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJD_NUM"},{"type":"string","optional":true,"field":"SQL_REDO"},{"type":"string","optional":true,"field":"SQL_UNDO"},{"type":"string","optional":true,"field":"RS_ID"},{"type":"int64","optional":true,"field":"SSN"},{"type":"boolean","optional":true,"field":"CSF"},{"type":"string","optional":true,"field":"INFO"},{"type":"int32","optional":true,"field":"STATUS"},{"type":"int64","optional":true,"field":"REDO_VALUE"},{"type":"int64","optional":true,"field":"UNDO_VALUE"},{"type":"int64","optional":true,"field":"SAFE_RESUME_SCN"},{"type":"int64","optional":true,"field":"CSCN"},{"type":"bytes","optional":true,"field":"OBJECT_ID"},{"type":"string","optional":true,"field":"EDITION_NAME"},{"type":"string","optional":true,"field":"CLIENT_ID"},{"type":"string","optional":true,"field":"SRC_CON_NAME"},{"type":"int64","optional":true,"field":"SRC_CON_ID"},{"type":"int64","optional":true,"field":"SRC_CON_UID"},{"type":"int64","optional":true,"field":"SRC_CON_DBID"},{"type":"bytes","optional":true,"field":"SRC_CON_GUID"},{"type":"boolean","optional":true,"field":"CON_ID"}],"optional":false},"payload":{"SCN":1445212,"START_SCN":1445212,"COMMIT_SCN":1445213,"TIMESTAMP":1631536048000,"START_TIMESTAMP":1631536048000,"COMMIT_TIMESTAMP":1631536048000,"XIDUSN":8,"XIDSLT":31,"XIDSQN":743,"XID":"CAAfAOcCAAA=","PXIDUSN":8,"PXIDSLT":31,"PXIDSQN":743,"PXID":"CAAfAOcCAAA=","TX_NAME":null,"OPERATION":"INSERT","OPERATION_CODE":1,"ROLLBACK":false,"SEG_OWNER":"C##MYUSER","SEG_NAME":"CUSTOMERS","TABLE_NAME":"CUSTOMERS","SEG_TYPE":2,"SEG_TYPE_NAME":"TABLE","TABLE_SPACE":"USERS","ROW_ID":"AAAR9TAAHAAAACHAAF","USERNAME":"C##MYUSER","OS_USERNAME":"oracle","MACHINE_NAME":"oracle","AUDIT_SESSIONID":70001,"SESSION_NUM":869,"SERIAL_NUM":46182,"SESSION_INFO":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3182 OS_program_name=sqlplus@oracle (TNS V1-V3)","THREAD_NUM":1,"SEQUENCE_NUM":2,"RBASQN":2,"RBABLK":150188,"RBABYTE":16,"UBAFIL":4,"UBABLK":16784116,"UBAREC":8,"UBASQN":272,"ABS_FILE_NUM":7,"REL_FILE_NUM":7,"DATA_BLK_NUM":135,"DATA_OBJ_NUM":73555,"DATA_OBJV_NUM":1,"DATA_OBJD_NUM":73555,"SQL_REDO":"insert into \"C##MYUSER\".\"CUSTOMERS\"(\"ID\",\"FIRST_NAME\",\"LAST_NAME\",\"EMAIL\",\"GENDER\",\"CLUB_STATUS\",\"COMMENTS\",\"CREATE_TS\",\"UPDATE_TS\") values ('42','Frantz','Kafka','fkafka@confluent.io','Male','bronze','Evil is whatever distracts',TO_TIMESTAMP('2021-09-13 12:27:28.673'),TO_TIMESTAMP('2021-09-13 12:27:28.000'));","SQL_UNDO":"delete from \"C##MYUSER\".\"CUSTOMERS\" where \"ID\" = '42' and \"FIRST_NAME\" = 'Frantz' and \"LAST_NAME\" = 'Kafka' and \"EMAIL\" = 'fkafka@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'bronze' and \"COMMENTS\" = 'Evil is whatever distracts' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.673') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.000') and ROWID = 'AAAR9TAAHAAAACHAAF';","RS_ID":" 0x000002.00024aac.0010 ","SSN":5,"CSF":false,"INFO":null,"STATUS":0,"REDO_VALUE":322,"UNDO_VALUE":323,"SAFE_RESUME_SCN":0,"CSCN":1445213,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":"CDB$ROOT","SRC_CON_ID":1,"SRC_CON_UID":1,"SRC_CON_DBID":0,"SRC_CON_GUID":null,"CON_ID":false}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":true,"field":"SCN"},{"type":"int64","optional":true,"field":"START_SCN"},{"type":"int64","optional":true,"field":"COMMIT_SCN"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"START_TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"COMMIT_TIMESTAMP"},{"type":"int64","optional":true,"field":"XIDUSN"},{"type":"int64","optional":true,"field":"XIDSLT"},{"type":"int64","optional":true,"field":"XIDSQN"},{"type":"bytes","optional":true,"field":"XID"},{"type":"int64","optional":true,"field":"PXIDUSN"},{"type":"int64","optional":true,"field":"PXIDSLT"},{"type":"int64","optional":true,"field":"PXIDSQN"},{"type":"bytes","optional":true,"field":"PXID"},{"type":"string","optional":true,"field":"TX_NAME"},{"type":"string","optional":true,"field":"OPERATION"},{"type":"int8","optional":true,"field":"OPERATION_CODE"},{"type":"boolean","optional":true,"field":"ROLLBACK"},{"type":"string","optional":true,"field":"SEG_OWNER"},{"type":"string","optional":true,"field":"SEG_NAME"},{"type":"string","optional":true,"field":"TABLE_NAME"},{"type":"int8","optional":true,"field":"SEG_TYPE"},{"type":"string","optional":true,"field":"SEG_TYPE_NAME"},{"type":"string","optional":true,"field":"TABLE_SPACE"},{"type":"string","optional":true,"field":"ROW_ID"},{"type":"string","optional":true,"field":"USERNAME"},{"type":"string","optional":true,"field":"OS_USERNAME"},{"type":"string","optional":true,"field":"MACHINE_NAME"},{"type":"int64","optional":true,"field":"AUDIT_SESSIONID"},{"type":"int64","optional":true,"field":"SESSION_NUM"},{"type":"int64","optional":true,"field":"SERIAL_NUM"},{"type":"string","optional":true,"field":"SESSION_INFO"},{"type":"int64","optional":true,"field":"THREAD_NUM"},{"type":"int64","optional":true,"field":"SEQUENCE_NUM"},{"type":"int64","optional":true,"field":"RBASQN"},{"type":"int64","optional":true,"field":"RBABLK"},{"type":"int64","optional":true,"field":"RBABYTE"},{"type":"int64","optional":true,"field":"UBAFIL"},{"type":"int64","optional":true,"field":"UBABLK"},{"type":"int64","optional":true,"field":"UBAREC"},{"type":"int64","optional":true,"field":"UBASQN"},{"type":"int64","optional":true,"field":"ABS_FILE_NUM"},{"type":"int64","optional":true,"field":"REL_FILE_NUM"},{"type":"int64","optional":true,"field":"DATA_BLK_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJ_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJV_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJD_NUM"},{"type":"string","optional":true,"field":"SQL_REDO"},{"type":"string","optional":true,"field":"SQL_UNDO"},{"type":"string","optional":true,"field":"RS_ID"},{"type":"int64","optional":true,"field":"SSN"},{"type":"boolean","optional":true,"field":"CSF"},{"type":"string","optional":true,"field":"INFO"},{"type":"int32","optional":true,"field":"STATUS"},{"type":"int64","optional":true,"field":"REDO_VALUE"},{"type":"int64","optional":true,"field":"UNDO_VALUE"},{"type":"int64","optional":true,"field":"SAFE_RESUME_SCN"},{"type":"int64","optional":true,"field":"CSCN"},{"type":"bytes","optional":true,"field":"OBJECT_ID"},{"type":"string","optional":true,"field":"EDITION_NAME"},{"type":"string","optional":true,"field":"CLIENT_ID"},{"type":"string","optional":true,"field":"SRC_CON_NAME"},{"type":"int64","optional":true,"field":"SRC_CON_ID"},{"type":"int64","optional":true,"field":"SRC_CON_UID"},{"type":"int64","optional":true,"field":"SRC_CON_DBID"},{"type":"bytes","optional":true,"field":"SRC_CON_GUID"},{"type":"boolean","optional":true,"field":"CON_ID"}],"optional":false},"payload":{"SCN":1445212,"START_SCN":1445212,"COMMIT_SCN":1445213,"TIMESTAMP":1631536048000,"START_TIMESTAMP":1631536048000,"COMMIT_TIMESTAMP":1631536048000,"XIDUSN":8,"XIDSLT":31,"XIDSQN":743,"XID":"CAAfAOcCAAA=","PXIDUSN":8,"PXIDSLT":31,"PXIDSQN":743,"PXID":"CAAfAOcCAAA=","TX_NAME":null,"OPERATION":"INSERT","OPERATION_CODE":1,"ROLLBACK":false,"SEG_OWNER":"C##MYUSER","SEG_NAME":"CUSTOMERS","TABLE_NAME":"CUSTOMERS","SEG_TYPE":2,"SEG_TYPE_NAME":"TABLE","TABLE_SPACE":"USERS","ROW_ID":"AAAR9TAAHAAAACHAAG","USERNAME":"C##MYUSER","OS_USERNAME":"oracle","MACHINE_NAME":"oracle","AUDIT_SESSIONID":70001,"SESSION_NUM":869,"SERIAL_NUM":46182,"SESSION_INFO":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3182 OS_program_name=sqlplus@oracle (TNS V1-V3)","THREAD_NUM":1,"SEQUENCE_NUM":3,"RBASQN":2,"RBABLK":150189,"RBABYTE":472,"UBAFIL":4,"UBABLK":16784116,"UBAREC":10,"UBASQN":272,"ABS_FILE_NUM":7,"REL_FILE_NUM":7,"DATA_BLK_NUM":135,"DATA_OBJ_NUM":73555,"DATA_OBJV_NUM":1,"DATA_OBJD_NUM":73555,"SQL_REDO":"insert into \"C##MYUSER\".\"CUSTOMERS\"(\"ID\",\"FIRST_NAME\",\"LAST_NAME\",\"EMAIL\",\"GENDER\",\"CLUB_STATUS\",\"COMMENTS\",\"CREATE_TS\",\"UPDATE_TS\") values ('43','Gregor','Samsa','gsamsa@confluent.io','Male','platinium','How about if I sleep a little bit longer and forget all this nonsense',TO_TIMESTAMP('2021-09-13 12:27:28.676'),TO_TIMESTAMP('2021-09-13 12:27:28.000'));","SQL_UNDO":"delete from \"C##MYUSER\".\"CUSTOMERS\" where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'platinium' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.676') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.000') and ROWID = 'AAAR9TAAHAAAACHAAG';","RS_ID":" 0x000002.00024aad.01d8 ","SSN":6,"CSF":false,"INFO":null,"STATUS":0,"REDO_VALUE":324,"UNDO_VALUE":325,"SAFE_RESUME_SCN":0,"CSCN":1445213,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":"CDB$ROOT","SRC_CON_ID":1,"SRC_CON_UID":1,"SRC_CON_DBID":0,"SRC_CON_GUID":null,"CON_ID":false}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":true,"field":"SCN"},{"type":"int64","optional":true,"field":"START_SCN"},{"type":"int64","optional":true,"field":"COMMIT_SCN"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"START_TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"COMMIT_TIMESTAMP"},{"type":"int64","optional":true,"field":"XIDUSN"},{"type":"int64","optional":true,"field":"XIDSLT"},{"type":"int64","optional":true,"field":"XIDSQN"},{"type":"bytes","optional":true,"field":"XID"},{"type":"int64","optional":true,"field":"PXIDUSN"},{"type":"int64","optional":true,"field":"PXIDSLT"},{"type":"int64","optional":true,"field":"PXIDSQN"},{"type":"bytes","optional":true,"field":"PXID"},{"type":"string","optional":true,"field":"TX_NAME"},{"type":"string","optional":true,"field":"OPERATION"},{"type":"int8","optional":true,"field":"OPERATION_CODE"},{"type":"boolean","optional":true,"field":"ROLLBACK"},{"type":"string","optional":true,"field":"SEG_OWNER"},{"type":"string","optional":true,"field":"SEG_NAME"},{"type":"string","optional":true,"field":"TABLE_NAME"},{"type":"int8","optional":true,"field":"SEG_TYPE"},{"type":"string","optional":true,"field":"SEG_TYPE_NAME"},{"type":"string","optional":true,"field":"TABLE_SPACE"},{"type":"string","optional":true,"field":"ROW_ID"},{"type":"string","optional":true,"field":"USERNAME"},{"type":"string","optional":true,"field":"OS_USERNAME"},{"type":"string","optional":true,"field":"MACHINE_NAME"},{"type":"int64","optional":true,"field":"AUDIT_SESSIONID"},{"type":"int64","optional":true,"field":"SESSION_NUM"},{"type":"int64","optional":true,"field":"SERIAL_NUM"},{"type":"string","optional":true,"field":"SESSION_INFO"},{"type":"int64","optional":true,"field":"THREAD_NUM"},{"type":"int64","optional":true,"field":"SEQUENCE_NUM"},{"type":"int64","optional":true,"field":"RBASQN"},{"type":"int64","optional":true,"field":"RBABLK"},{"type":"int64","optional":true,"field":"RBABYTE"},{"type":"int64","optional":true,"field":"UBAFIL"},{"type":"int64","optional":true,"field":"UBABLK"},{"type":"int64","optional":true,"field":"UBAREC"},{"type":"int64","optional":true,"field":"UBASQN"},{"type":"int64","optional":true,"field":"ABS_FILE_NUM"},{"type":"int64","optional":true,"field":"REL_FILE_NUM"},{"type":"int64","optional":true,"field":"DATA_BLK_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJ_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJV_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJD_NUM"},{"type":"string","optional":true,"field":"SQL_REDO"},{"type":"string","optional":true,"field":"SQL_UNDO"},{"type":"string","optional":true,"field":"RS_ID"},{"type":"int64","optional":true,"field":"SSN"},{"type":"boolean","optional":true,"field":"CSF"},{"type":"string","optional":true,"field":"INFO"},{"type":"int32","optional":true,"field":"STATUS"},{"type":"int64","optional":true,"field":"REDO_VALUE"},{"type":"int64","optional":true,"field":"UNDO_VALUE"},{"type":"int64","optional":true,"field":"SAFE_RESUME_SCN"},{"type":"int64","optional":true,"field":"CSCN"},{"type":"bytes","optional":true,"field":"OBJECT_ID"},{"type":"string","optional":true,"field":"EDITION_NAME"},{"type":"string","optional":true,"field":"CLIENT_ID"},{"type":"string","optional":true,"field":"SRC_CON_NAME"},{"type":"int64","optional":true,"field":"SRC_CON_ID"},{"type":"int64","optional":true,"field":"SRC_CON_UID"},{"type":"int64","optional":true,"field":"SRC_CON_DBID"},{"type":"bytes","optional":true,"field":"SRC_CON_GUID"},{"type":"boolean","optional":true,"field":"CON_ID"}],"optional":false},"payload":{"SCN":1445219,"START_SCN":1445219,"COMMIT_SCN":1445220,"TIMESTAMP":1631536049000,"START_TIMESTAMP":1631536049000,"COMMIT_TIMESTAMP":1631536049000,"XIDUSN":4,"XIDSLT":2,"XIDSQN":519,"XID":"BAACAAcCAAA=","PXIDUSN":4,"PXIDSLT":2,"PXIDSQN":519,"PXID":"BAACAAcCAAA=","TX_NAME":null,"OPERATION":"UPDATE","OPERATION_CODE":3,"ROLLBACK":false,"SEG_OWNER":"C##MYUSER","SEG_NAME":"CUSTOMERS","TABLE_NAME":"CUSTOMERS","SEG_TYPE":2,"SEG_TYPE_NAME":"TABLE","TABLE_SPACE":"USERS","ROW_ID":"AAAR9TAAHAAAACHAAF","USERNAME":"C##MYUSER","OS_USERNAME":"oracle","MACHINE_NAME":"oracle","AUDIT_SESSIONID":70002,"SESSION_NUM":869,"SERIAL_NUM":63181,"SESSION_INFO":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3190 OS_program_name=sqlplus@oracle (TNS V1-V3)","THREAD_NUM":1,"SEQUENCE_NUM":3,"RBASQN":2,"RBABLK":150197,"RBABYTE":100,"UBAFIL":4,"UBABLK":16783902,"UBAREC":15,"UBASQN":155,"ABS_FILE_NUM":4,"REL_FILE_NUM":7,"DATA_BLK_NUM":135,"DATA_OBJ_NUM":73555,"DATA_OBJV_NUM":1,"DATA_OBJD_NUM":73555,"SQL_REDO":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'gold', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:29.000') where \"ID\" = '42' and \"FIRST_NAME\" = 'Frantz' and \"LAST_NAME\" = 'Kafka' and \"EMAIL\" = 'fkafka@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'bronze' and \"COMMENTS\" = 'Evil is whatever distracts' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.673') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.000') and ROWID = 'AAAR9TAAHAAAACHAAF';","SQL_UNDO":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'bronze', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.000') where \"ID\" = '42' and \"FIRST_NAME\" = 'Frantz' and \"LAST_NAME\" = 'Kafka' and \"EMAIL\" = 'fkafka@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'gold' and \"COMMENTS\" = 'Evil is whatever distracts' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.673') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:29.000') and ROWID = 'AAAR9TAAHAAAACHAAF';","RS_ID":" 0x000002.00024ab5.0064 ","SSN":0,"CSF":false,"INFO":null,"STATUS":0,"REDO_VALUE":338,"UNDO_VALUE":339,"SAFE_RESUME_SCN":0,"CSCN":1445220,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":"CDB$ROOT","SRC_CON_ID":1,"SRC_CON_UID":1,"SRC_CON_DBID":0,"SRC_CON_GUID":null,"CON_ID":false}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":true,"field":"SCN"},{"type":"int64","optional":true,"field":"START_SCN"},{"type":"int64","optional":true,"field":"COMMIT_SCN"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"START_TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"COMMIT_TIMESTAMP"},{"type":"int64","optional":true,"field":"XIDUSN"},{"type":"int64","optional":true,"field":"XIDSLT"},{"type":"int64","optional":true,"field":"XIDSQN"},{"type":"bytes","optional":true,"field":"XID"},{"type":"int64","optional":true,"field":"PXIDUSN"},{"type":"int64","optional":true,"field":"PXIDSLT"},{"type":"int64","optional":true,"field":"PXIDSQN"},{"type":"bytes","optional":true,"field":"PXID"},{"type":"string","optional":true,"field":"TX_NAME"},{"type":"string","optional":true,"field":"OPERATION"},{"type":"int8","optional":true,"field":"OPERATION_CODE"},{"type":"boolean","optional":true,"field":"ROLLBACK"},{"type":"string","optional":true,"field":"SEG_OWNER"},{"type":"string","optional":true,"field":"SEG_NAME"},{"type":"string","optional":true,"field":"TABLE_NAME"},{"type":"int8","optional":true,"field":"SEG_TYPE"},{"type":"string","optional":true,"field":"SEG_TYPE_NAME"},{"type":"string","optional":true,"field":"TABLE_SPACE"},{"type":"string","optional":true,"field":"ROW_ID"},{"type":"string","optional":true,"field":"USERNAME"},{"type":"string","optional":true,"field":"OS_USERNAME"},{"type":"string","optional":true,"field":"MACHINE_NAME"},{"type":"int64","optional":true,"field":"AUDIT_SESSIONID"},{"type":"int64","optional":true,"field":"SESSION_NUM"},{"type":"int64","optional":true,"field":"SERIAL_NUM"},{"type":"string","optional":true,"field":"SESSION_INFO"},{"type":"int64","optional":true,"field":"THREAD_NUM"},{"type":"int64","optional":true,"field":"SEQUENCE_NUM"},{"type":"int64","optional":true,"field":"RBASQN"},{"type":"int64","optional":true,"field":"RBABLK"},{"type":"int64","optional":true,"field":"RBABYTE"},{"type":"int64","optional":true,"field":"UBAFIL"},{"type":"int64","optional":true,"field":"UBABLK"},{"type":"int64","optional":true,"field":"UBAREC"},{"type":"int64","optional":true,"field":"UBASQN"},{"type":"int64","optional":true,"field":"ABS_FILE_NUM"},{"type":"int64","optional":true,"field":"REL_FILE_NUM"},{"type":"int64","optional":true,"field":"DATA_BLK_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJ_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJV_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJD_NUM"},{"type":"string","optional":true,"field":"SQL_REDO"},{"type":"string","optional":true,"field":"SQL_UNDO"},{"type":"string","optional":true,"field":"RS_ID"},{"type":"int64","optional":true,"field":"SSN"},{"type":"boolean","optional":true,"field":"CSF"},{"type":"string","optional":true,"field":"INFO"},{"type":"int32","optional":true,"field":"STATUS"},{"type":"int64","optional":true,"field":"REDO_VALUE"},{"type":"int64","optional":true,"field":"UNDO_VALUE"},{"type":"int64","optional":true,"field":"SAFE_RESUME_SCN"},{"type":"int64","optional":true,"field":"CSCN"},{"type":"bytes","optional":true,"field":"OBJECT_ID"},{"type":"string","optional":true,"field":"EDITION_NAME"},{"type":"string","optional":true,"field":"CLIENT_ID"},{"type":"string","optional":true,"field":"SRC_CON_NAME"},{"type":"int64","optional":true,"field":"SRC_CON_ID"},{"type":"int64","optional":true,"field":"SRC_CON_UID"},{"type":"int64","optional":true,"field":"SRC_CON_DBID"},{"type":"bytes","optional":true,"field":"SRC_CON_GUID"},{"type":"boolean","optional":true,"field":"CON_ID"}],"optional":false},"payload":{"SCN":1445226,"START_SCN":1445226,"COMMIT_SCN":1445227,"TIMESTAMP":1631536049000,"START_TIMESTAMP":1631536049000,"COMMIT_TIMESTAMP":1631536049000,"XIDUSN":4,"XIDSLT":3,"XIDSQN":519,"XID":"BAADAAcCAAA=","PXIDUSN":4,"PXIDSLT":3,"PXIDSQN":519,"PXID":"BAADAAcCAAA=","TX_NAME":null,"OPERATION":"DELETE","OPERATION_CODE":2,"ROLLBACK":false,"SEG_OWNER":"C##MYUSER","SEG_NAME":"CUSTOMERS","TABLE_NAME":"CUSTOMERS","SEG_TYPE":2,"SEG_TYPE_NAME":"TABLE","TABLE_SPACE":"USERS","ROW_ID":"AAAR9TAAHAAAACHAAF","USERNAME":"C##MYUSER","OS_USERNAME":"oracle","MACHINE_NAME":"oracle","AUDIT_SESSIONID":70003,"SESSION_NUM":869,"SERIAL_NUM":36434,"SESSION_INFO":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3197 OS_program_name=sqlplus@oracle (TNS V1-V3)","THREAD_NUM":1,"SEQUENCE_NUM":2,"RBASQN":2,"RBABLK":150203,"RBABYTE":16,"UBAFIL":4,"UBABLK":0,"UBAREC":0,"UBASQN":0,"ABS_FILE_NUM":4,"REL_FILE_NUM":7,"DATA_BLK_NUM":135,"DATA_OBJ_NUM":73555,"DATA_OBJV_NUM":1,"DATA_OBJD_NUM":73555,"SQL_REDO":"delete from \"C##MYUSER\".\"CUSTOMERS\" where \"ID\" = '42' and \"FIRST_NAME\" = 'Frantz' and \"LAST_NAME\" = 'Kafka' and \"EMAIL\" = 'fkafka@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'gold' and \"COMMENTS\" = 'Evil is whatever distracts' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.673') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:29.000') and ROWID = 'AAAR9TAAHAAAACHAAF';","SQL_UNDO":"insert into \"C##MYUSER\".\"CUSTOMERS\"(\"ID\",\"FIRST_NAME\",\"LAST_NAME\",\"EMAIL\",\"GENDER\",\"CLUB_STATUS\",\"COMMENTS\",\"CREATE_TS\",\"UPDATE_TS\") values ('42','Frantz','Kafka','fkafka@confluent.io','Male','gold','Evil is whatever distracts',TO_TIMESTAMP('2021-09-13 12:27:28.673'),TO_TIMESTAMP('2021-09-13 12:27:29.000'));","RS_ID":" 0x000002.00024abb.0010 ","SSN":0,"CSF":false,"INFO":null,"STATUS":0,"REDO_VALUE":350,"UNDO_VALUE":351,"SAFE_RESUME_SCN":0,"CSCN":1445227,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":"CDB$ROOT","SRC_CON_ID":1,"SRC_CON_UID":1,"SRC_CON_DBID":0,"SRC_CON_GUID":null,"CON_ID":false}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":true,"field":"SCN"},{"type":"int64","optional":true,"field":"START_SCN"},{"type":"int64","optional":true,"field":"COMMIT_SCN"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"START_TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"COMMIT_TIMESTAMP"},{"type":"int64","optional":true,"field":"XIDUSN"},{"type":"int64","optional":true,"field":"XIDSLT"},{"type":"int64","optional":true,"field":"XIDSQN"},{"type":"bytes","optional":true,"field":"XID"},{"type":"int64","optional":true,"field":"PXIDUSN"},{"type":"int64","optional":true,"field":"PXIDSLT"},{"type":"int64","optional":true,"field":"PXIDSQN"},{"type":"bytes","optional":true,"field":"PXID"},{"type":"string","optional":true,"field":"TX_NAME"},{"type":"string","optional":true,"field":"OPERATION"},{"type":"int8","optional":true,"field":"OPERATION_CODE"},{"type":"boolean","optional":true,"field":"ROLLBACK"},{"type":"string","optional":true,"field":"SEG_OWNER"},{"type":"string","optional":true,"field":"SEG_NAME"},{"type":"string","optional":true,"field":"TABLE_NAME"},{"type":"int8","optional":true,"field":"SEG_TYPE"},{"type":"string","optional":true,"field":"SEG_TYPE_NAME"},{"type":"string","optional":true,"field":"TABLE_SPACE"},{"type":"string","optional":true,"field":"ROW_ID"},{"type":"string","optional":true,"field":"USERNAME"},{"type":"string","optional":true,"field":"OS_USERNAME"},{"type":"string","optional":true,"field":"MACHINE_NAME"},{"type":"int64","optional":true,"field":"AUDIT_SESSIONID"},{"type":"int64","optional":true,"field":"SESSION_NUM"},{"type":"int64","optional":true,"field":"SERIAL_NUM"},{"type":"string","optional":true,"field":"SESSION_INFO"},{"type":"int64","optional":true,"field":"THREAD_NUM"},{"type":"int64","optional":true,"field":"SEQUENCE_NUM"},{"type":"int64","optional":true,"field":"RBASQN"},{"type":"int64","optional":true,"field":"RBABLK"},{"type":"int64","optional":true,"field":"RBABYTE"},{"type":"int64","optional":true,"field":"UBAFIL"},{"type":"int64","optional":true,"field":"UBABLK"},{"type":"int64","optional":true,"field":"UBAREC"},{"type":"int64","optional":true,"field":"UBASQN"},{"type":"int64","optional":true,"field":"ABS_FILE_NUM"},{"type":"int64","optional":true,"field":"REL_FILE_NUM"},{"type":"int64","optional":true,"field":"DATA_BLK_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJ_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJV_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJD_NUM"},{"type":"string","optional":true,"field":"SQL_REDO"},{"type":"string","optional":true,"field":"SQL_UNDO"},{"type":"string","optional":true,"field":"RS_ID"},{"type":"int64","optional":true,"field":"SSN"},{"type":"boolean","optional":true,"field":"CSF"},{"type":"string","optional":true,"field":"INFO"},{"type":"int32","optional":true,"field":"STATUS"},{"type":"int64","optional":true,"field":"REDO_VALUE"},{"type":"int64","optional":true,"field":"UNDO_VALUE"},{"type":"int64","optional":true,"field":"SAFE_RESUME_SCN"},{"type":"int64","optional":true,"field":"CSCN"},{"type":"bytes","optional":true,"field":"OBJECT_ID"},{"type":"string","optional":true,"field":"EDITION_NAME"},{"type":"string","optional":true,"field":"CLIENT_ID"},{"type":"string","optional":true,"field":"SRC_CON_NAME"},{"type":"int64","optional":true,"field":"SRC_CON_ID"},{"type":"int64","optional":true,"field":"SRC_CON_UID"},{"type":"int64","optional":true,"field":"SRC_CON_DBID"},{"type":"bytes","optional":true,"field":"SRC_CON_GUID"},{"type":"boolean","optional":true,"field":"CON_ID"}],"optional":false},"payload":{"SCN":1445237,"START_SCN":null,"COMMIT_SCN":null,"TIMESTAMP":1631536050000,"START_TIMESTAMP":null,"COMMIT_TIMESTAMP":null,"XIDUSN":2,"XIDSLT":32,"XIDSQN":710,"XID":"AgAgAMYCAAA=","PXIDUSN":2,"PXIDSLT":32,"PXIDSQN":710,"PXID":"AgAgAMYCAAA=","TX_NAME":null,"OPERATION":"DDL","OPERATION_CODE":5,"ROLLBACK":false,"SEG_OWNER":"C##MYUSER","SEG_NAME":"CUSTOMERS","TABLE_NAME":"CUSTOMERS","SEG_TYPE":2,"SEG_TYPE_NAME":"TABLE","TABLE_SPACE":null,"ROW_ID":"AAAAAAAAAAAAAAAAAB","USERNAME":"C##MYUSER","OS_USERNAME":"oracle","MACHINE_NAME":"oracle","AUDIT_SESSIONID":70004,"SESSION_NUM":869,"SERIAL_NUM":53332,"SESSION_INFO":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3204 OS_program_name=sqlplus@oracle (TNS V1-V3)","THREAD_NUM":1,"SEQUENCE_NUM":4,"RBASQN":2,"RBABLK":150213,"RBABYTE":200,"UBAFIL":4,"UBABLK":0,"UBAREC":0,"UBASQN":0,"ABS_FILE_NUM":0,"REL_FILE_NUM":0,"DATA_BLK_NUM":0,"DATA_OBJ_NUM":73555,"DATA_OBJV_NUM":2,"DATA_OBJD_NUM":0,"SQL_REDO":"  alter table CUSTOMERS add (\n    country VARCHAR(50)\n  );","SQL_UNDO":null,"RS_ID":" 0x000002.00024ac5.00c8 ","SSN":0,"CSF":false,"INFO":"USER DDL (PlSql=0 RecDep=0)","STATUS":0,"REDO_VALUE":366,"UNDO_VALUE":367,"SAFE_RESUME_SCN":null,"CSCN":null,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":"CDB$ROOT","SRC_CON_ID":1,"SRC_CON_UID":1,"SRC_CON_DBID":0,"SRC_CON_GUID":null,"CON_ID":false}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":true,"field":"SCN"},{"type":"int64","optional":true,"field":"START_SCN"},{"type":"int64","optional":true,"field":"COMMIT_SCN"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"START_TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"COMMIT_TIMESTAMP"},{"type":"int64","optional":true,"field":"XIDUSN"},{"type":"int64","optional":true,"field":"XIDSLT"},{"type":"int64","optional":true,"field":"XIDSQN"},{"type":"bytes","optional":true,"field":"XID"},{"type":"int64","optional":true,"field":"PXIDUSN"},{"type":"int64","optional":true,"field":"PXIDSLT"},{"type":"int64","optional":true,"field":"PXIDSQN"},{"type":"bytes","optional":true,"field":"PXID"},{"type":"string","optional":true,"field":"TX_NAME"},{"type":"string","optional":true,"field":"OPERATION"},{"type":"int8","optional":true,"field":"OPERATION_CODE"},{"type":"boolean","optional":true,"field":"ROLLBACK"},{"type":"string","optional":true,"field":"SEG_OWNER"},{"type":"string","optional":true,"field":"SEG_NAME"},{"type":"string","optional":true,"field":"TABLE_NAME"},{"type":"int8","optional":true,"field":"SEG_TYPE"},{"type":"string","optional":true,"field":"SEG_TYPE_NAME"},{"type":"string","optional":true,"field":"TABLE_SPACE"},{"type":"string","optional":true,"field":"ROW_ID"},{"type":"string","optional":true,"field":"USERNAME"},{"type":"string","optional":true,"field":"OS_USERNAME"},{"type":"string","optional":true,"field":"MACHINE_NAME"},{"type":"int64","optional":true,"field":"AUDIT_SESSIONID"},{"type":"int64","optional":true,"field":"SESSION_NUM"},{"type":"int64","optional":true,"field":"SERIAL_NUM"},{"type":"string","optional":true,"field":"SESSION_INFO"},{"type":"int64","optional":true,"field":"THREAD_NUM"},{"type":"int64","optional":true,"field":"SEQUENCE_NUM"},{"type":"int64","optional":true,"field":"RBASQN"},{"type":"int64","optional":true,"field":"RBABLK"},{"type":"int64","optional":true,"field":"RBABYTE"},{"type":"int64","optional":true,"field":"UBAFIL"},{"type":"int64","optional":true,"field":"UBABLK"},{"type":"int64","optional":true,"field":"UBAREC"},{"type":"int64","optional":true,"field":"UBASQN"},{"type":"int64","optional":true,"field":"ABS_FILE_NUM"},{"type":"int64","optional":true,"field":"REL_FILE_NUM"},{"type":"int64","optional":true,"field":"DATA_BLK_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJ_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJV_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJD_NUM"},{"type":"string","optional":true,"field":"SQL_REDO"},{"type":"string","optional":true,"field":"SQL_UNDO"},{"type":"string","optional":true,"field":"RS_ID"},{"type":"int64","optional":true,"field":"SSN"},{"type":"boolean","optional":true,"field":"CSF"},{"type":"string","optional":true,"field":"INFO"},{"type":"int32","optional":true,"field":"STATUS"},{"type":"int64","optional":true,"field":"REDO_VALUE"},{"type":"int64","optional":true,"field":"UNDO_VALUE"},{"type":"int64","optional":true,"field":"SAFE_RESUME_SCN"},{"type":"int64","optional":true,"field":"CSCN"},{"type":"bytes","optional":true,"field":"OBJECT_ID"},{"type":"string","optional":true,"field":"EDITION_NAME"},{"type":"string","optional":true,"field":"CLIENT_ID"},{"type":"string","optional":true,"field":"SRC_CON_NAME"},{"type":"int64","optional":true,"field":"SRC_CON_ID"},{"type":"int64","optional":true,"field":"SRC_CON_UID"},{"type":"int64","optional":true,"field":"SRC_CON_DBID"},{"type":"bytes","optional":true,"field":"SRC_CON_GUID"},{"type":"boolean","optional":true,"field":"CON_ID"}],"optional":false},"payload":{"SCN":1445248,"START_SCN":1445248,"COMMIT_SCN":1445250,"TIMESTAMP":1631536050000,"START_TIMESTAMP":1631536050000,"COMMIT_TIMESTAMP":1631536050000,"XIDUSN":9,"XIDSLT":32,"XIDSQN":715,"XID":"CQAgAMsCAAA=","PXIDUSN":9,"PXIDSLT":32,"PXIDSQN":715,"PXID":"CQAgAMsCAAA=","TX_NAME":null,"OPERATION":"INSERT","OPERATION_CODE":1,"ROLLBACK":false,"SEG_OWNER":"C##MYUSER","SEG_NAME":"CUSTOMERS","TABLE_NAME":"CUSTOMERS","SEG_TYPE":2,"SEG_TYPE_NAME":"TABLE","TABLE_SPACE":"USERS","ROW_ID":"AAAR9TAAHAAAACHAAH","USERNAME":"C##MYUSER","OS_USERNAME":"oracle","MACHINE_NAME":"oracle","AUDIT_SESSIONID":80001,"SESSION_NUM":869,"SERIAL_NUM":36556,"SESSION_INFO":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3212 OS_program_name=sqlplus@oracle (TNS V1-V3)","THREAD_NUM":1,"SEQUENCE_NUM":2,"RBASQN":2,"RBABLK":150229,"RBABYTE":16,"UBAFIL":4,"UBABLK":16783684,"UBAREC":27,"UBASQN":204,"ABS_FILE_NUM":7,"REL_FILE_NUM":7,"DATA_BLK_NUM":135,"DATA_OBJ_NUM":73555,"DATA_OBJV_NUM":2,"DATA_OBJD_NUM":73555,"SQL_REDO":"insert into \"C##MYUSER\".\"CUSTOMERS\"(\"ID\",\"FIRST_NAME\",\"LAST_NAME\",\"EMAIL\",\"GENDER\",\"CLUB_STATUS\",\"COMMENTS\",\"CREATE_TS\",\"UPDATE_TS\",\"COUNTRY\") values ('44','Josef','K','jk@confluent.io','Male','bronze','How is it even possible for someone to be guilty',TO_TIMESTAMP('2021-09-13 12:27:30.602'),TO_TIMESTAMP('2021-09-13 12:27:30.000'),'Poland');","SQL_UNDO":"delete from \"C##MYUSER\".\"CUSTOMERS\" where \"ID\" = '44' and \"FIRST_NAME\" = 'Josef' and \"LAST_NAME\" = 'K' and \"EMAIL\" = 'jk@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'bronze' and \"COMMENTS\" = 'How is it even possible for someone to be guilty' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.602') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.000') and \"COUNTRY\" = 'Poland' and ROWID = 'AAAR9TAAHAAAACHAAH';","RS_ID":" 0x000002.00024ad5.0010 ","SSN":7,"CSF":false,"INFO":null,"STATUS":0,"REDO_VALUE":28,"UNDO_VALUE":29,"SAFE_RESUME_SCN":0,"CSCN":1445250,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":"CDB$ROOT","SRC_CON_ID":1,"SRC_CON_UID":1,"SRC_CON_DBID":0,"SRC_CON_GUID":null,"CON_ID":false}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":true,"field":"SCN"},{"type":"int64","optional":true,"field":"START_SCN"},{"type":"int64","optional":true,"field":"COMMIT_SCN"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"START_TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"COMMIT_TIMESTAMP"},{"type":"int64","optional":true,"field":"XIDUSN"},{"type":"int64","optional":true,"field":"XIDSLT"},{"type":"int64","optional":true,"field":"XIDSQN"},{"type":"bytes","optional":true,"field":"XID"},{"type":"int64","optional":true,"field":"PXIDUSN"},{"type":"int64","optional":true,"field":"PXIDSLT"},{"type":"int64","optional":true,"field":"PXIDSQN"},{"type":"bytes","optional":true,"field":"PXID"},{"type":"string","optional":true,"field":"TX_NAME"},{"type":"string","optional":true,"field":"OPERATION"},{"type":"int8","optional":true,"field":"OPERATION_CODE"},{"type":"boolean","optional":true,"field":"ROLLBACK"},{"type":"string","optional":true,"field":"SEG_OWNER"},{"type":"string","optional":true,"field":"SEG_NAME"},{"type":"string","optional":true,"field":"TABLE_NAME"},{"type":"int8","optional":true,"field":"SEG_TYPE"},{"type":"string","optional":true,"field":"SEG_TYPE_NAME"},{"type":"string","optional":true,"field":"TABLE_SPACE"},{"type":"string","optional":true,"field":"ROW_ID"},{"type":"string","optional":true,"field":"USERNAME"},{"type":"string","optional":true,"field":"OS_USERNAME"},{"type":"string","optional":true,"field":"MACHINE_NAME"},{"type":"int64","optional":true,"field":"AUDIT_SESSIONID"},{"type":"int64","optional":true,"field":"SESSION_NUM"},{"type":"int64","optional":true,"field":"SERIAL_NUM"},{"type":"string","optional":true,"field":"SESSION_INFO"},{"type":"int64","optional":true,"field":"THREAD_NUM"},{"type":"int64","optional":true,"field":"SEQUENCE_NUM"},{"type":"int64","optional":true,"field":"RBASQN"},{"type":"int64","optional":true,"field":"RBABLK"},{"type":"int64","optional":true,"field":"RBABYTE"},{"type":"int64","optional":true,"field":"UBAFIL"},{"type":"int64","optional":true,"field":"UBABLK"},{"type":"int64","optional":true,"field":"UBAREC"},{"type":"int64","optional":true,"field":"UBASQN"},{"type":"int64","optional":true,"field":"ABS_FILE_NUM"},{"type":"int64","optional":true,"field":"REL_FILE_NUM"},{"type":"int64","optional":true,"field":"DATA_BLK_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJ_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJV_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJD_NUM"},{"type":"string","optional":true,"field":"SQL_REDO"},{"type":"string","optional":true,"field":"SQL_UNDO"},{"type":"string","optional":true,"field":"RS_ID"},{"type":"int64","optional":true,"field":"SSN"},{"type":"boolean","optional":true,"field":"CSF"},{"type":"string","optional":true,"field":"INFO"},{"type":"int32","optional":true,"field":"STATUS"},{"type":"int64","optional":true,"field":"REDO_VALUE"},{"type":"int64","optional":true,"field":"UNDO_VALUE"},{"type":"int64","optional":true,"field":"SAFE_RESUME_SCN"},{"type":"int64","optional":true,"field":"CSCN"},{"type":"bytes","optional":true,"field":"OBJECT_ID"},{"type":"string","optional":true,"field":"EDITION_NAME"},{"type":"string","optional":true,"field":"CLIENT_ID"},{"type":"string","optional":true,"field":"SRC_CON_NAME"},{"type":"int64","optional":true,"field":"SRC_CON_ID"},{"type":"int64","optional":true,"field":"SRC_CON_UID"},{"type":"int64","optional":true,"field":"SRC_CON_DBID"},{"type":"bytes","optional":true,"field":"SRC_CON_GUID"},{"type":"boolean","optional":true,"field":"CON_ID"}],"optional":false},"payload":{"SCN":1445249,"START_SCN":1445248,"COMMIT_SCN":1445250,"TIMESTAMP":1631536050000,"START_TIMESTAMP":1631536050000,"COMMIT_TIMESTAMP":1631536050000,"XIDUSN":9,"XIDSLT":32,"XIDSQN":715,"XID":"CQAgAMsCAAA=","PXIDUSN":9,"PXIDSLT":32,"PXIDSQN":715,"PXID":"CQAgAMsCAAA=","TX_NAME":null,"OPERATION":"UPDATE","OPERATION_CODE":3,"ROLLBACK":false,"SEG_OWNER":"C##MYUSER","SEG_NAME":"CUSTOMERS","TABLE_NAME":"CUSTOMERS","SEG_TYPE":2,"SEG_TYPE_NAME":"TABLE","TABLE_SPACE":"USERS","ROW_ID":"AAAR9TAAHAAAACHAAG","USERNAME":"C##MYUSER","OS_USERNAME":"oracle","MACHINE_NAME":"oracle","AUDIT_SESSIONID":80001,"SESSION_NUM":869,"SERIAL_NUM":36556,"SESSION_INFO":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3212 OS_program_name=sqlplus@oracle (TNS V1-V3)","THREAD_NUM":1,"SEQUENCE_NUM":4,"RBASQN":2,"RBABLK":150234,"RBABYTE":28,"UBAFIL":4,"UBABLK":16783684,"UBAREC":29,"UBASQN":204,"ABS_FILE_NUM":4,"REL_FILE_NUM":7,"DATA_BLK_NUM":135,"DATA_OBJ_NUM":73555,"DATA_OBJV_NUM":2,"DATA_OBJD_NUM":73555,"SQL_REDO":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'silver', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.000') where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'platinium' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.676') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.000') and \"COUNTRY\" IS NULL and ROWID = 'AAAR9TAAHAAAACHAAG';","SQL_UNDO":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'platinium', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.000') where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'silver' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.676') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.000') and \"COUNTRY\" IS NULL and ROWID = 'AAAR9TAAHAAAACHAAG';","RS_ID":" 0x000002.00024ada.001c ","SSN":0,"CSF":false,"INFO":null,"STATUS":0,"REDO_VALUE":32,"UNDO_VALUE":33,"SAFE_RESUME_SCN":0,"CSCN":1445250,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":"CDB$ROOT","SRC_CON_ID":1,"SRC_CON_UID":1,"SRC_CON_DBID":0,"SRC_CON_GUID":null,"CON_ID":false}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":true,"field":"SCN"},{"type":"int64","optional":true,"field":"START_SCN"},{"type":"int64","optional":true,"field":"COMMIT_SCN"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"START_TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"COMMIT_TIMESTAMP"},{"type":"int64","optional":true,"field":"XIDUSN"},{"type":"int64","optional":true,"field":"XIDSLT"},{"type":"int64","optional":true,"field":"XIDSQN"},{"type":"bytes","optional":true,"field":"XID"},{"type":"int64","optional":true,"field":"PXIDUSN"},{"type":"int64","optional":true,"field":"PXIDSLT"},{"type":"int64","optional":true,"field":"PXIDSQN"},{"type":"bytes","optional":true,"field":"PXID"},{"type":"string","optional":true,"field":"TX_NAME"},{"type":"string","optional":true,"field":"OPERATION"},{"type":"int8","optional":true,"field":"OPERATION_CODE"},{"type":"boolean","optional":true,"field":"ROLLBACK"},{"type":"string","optional":true,"field":"SEG_OWNER"},{"type":"string","optional":true,"field":"SEG_NAME"},{"type":"string","optional":true,"field":"TABLE_NAME"},{"type":"int8","optional":true,"field":"SEG_TYPE"},{"type":"string","optional":true,"field":"SEG_TYPE_NAME"},{"type":"string","optional":true,"field":"TABLE_SPACE"},{"type":"string","optional":true,"field":"ROW_ID"},{"type":"string","optional":true,"field":"USERNAME"},{"type":"string","optional":true,"field":"OS_USERNAME"},{"type":"string","optional":true,"field":"MACHINE_NAME"},{"type":"int64","optional":true,"field":"AUDIT_SESSIONID"},{"type":"int64","optional":true,"field":"SESSION_NUM"},{"type":"int64","optional":true,"field":"SERIAL_NUM"},{"type":"string","optional":true,"field":"SESSION_INFO"},{"type":"int64","optional":true,"field":"THREAD_NUM"},{"type":"int64","optional":true,"field":"SEQUENCE_NUM"},{"type":"int64","optional":true,"field":"RBASQN"},{"type":"int64","optional":true,"field":"RBABLK"},{"type":"int64","optional":true,"field":"RBABYTE"},{"type":"int64","optional":true,"field":"UBAFIL"},{"type":"int64","optional":true,"field":"UBABLK"},{"type":"int64","optional":true,"field":"UBAREC"},{"type":"int64","optional":true,"field":"UBASQN"},{"type":"int64","optional":true,"field":"ABS_FILE_NUM"},{"type":"int64","optional":true,"field":"REL_FILE_NUM"},{"type":"int64","optional":true,"field":"DATA_BLK_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJ_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJV_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJD_NUM"},{"type":"string","optional":true,"field":"SQL_REDO"},{"type":"string","optional":true,"field":"SQL_UNDO"},{"type":"string","optional":true,"field":"RS_ID"},{"type":"int64","optional":true,"field":"SSN"},{"type":"boolean","optional":true,"field":"CSF"},{"type":"string","optional":true,"field":"INFO"},{"type":"int32","optional":true,"field":"STATUS"},{"type":"int64","optional":true,"field":"REDO_VALUE"},{"type":"int64","optional":true,"field":"UNDO_VALUE"},{"type":"int64","optional":true,"field":"SAFE_RESUME_SCN"},{"type":"int64","optional":true,"field":"CSCN"},{"type":"bytes","optional":true,"field":"OBJECT_ID"},{"type":"string","optional":true,"field":"EDITION_NAME"},{"type":"string","optional":true,"field":"CLIENT_ID"},{"type":"string","optional":true,"field":"SRC_CON_NAME"},{"type":"int64","optional":true,"field":"SRC_CON_ID"},{"type":"int64","optional":true,"field":"SRC_CON_UID"},{"type":"int64","optional":true,"field":"SRC_CON_DBID"},{"type":"bytes","optional":true,"field":"SRC_CON_GUID"},{"type":"boolean","optional":true,"field":"CON_ID"}],"optional":false},"payload":{"SCN":1445256,"START_SCN":1445256,"COMMIT_SCN":1445257,"TIMESTAMP":1631536051000,"START_TIMESTAMP":1631536051000,"COMMIT_TIMESTAMP":1631536051000,"XIDUSN":7,"XIDSLT":16,"XIDSQN":526,"XID":"BwAQAA4CAAA=","PXIDUSN":7,"PXIDSLT":16,"PXIDSQN":526,"PXID":"BwAQAA4CAAA=","TX_NAME":null,"OPERATION":"UPDATE","OPERATION_CODE":3,"ROLLBACK":false,"SEG_OWNER":"C##MYUSER","SEG_NAME":"CUSTOMERS","TABLE_NAME":"CUSTOMERS","SEG_TYPE":2,"SEG_TYPE_NAME":"TABLE","TABLE_SPACE":"USERS","ROW_ID":"AAAR9TAAHAAAACHAAG","USERNAME":"C##MYUSER","OS_USERNAME":"oracle","MACHINE_NAME":"oracle","AUDIT_SESSIONID":80002,"SESSION_NUM":869,"SERIAL_NUM":59836,"SESSION_INFO":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3220 OS_program_name=sqlplus@oracle (TNS V1-V3)","THREAD_NUM":1,"SEQUENCE_NUM":3,"RBASQN":2,"RBABLK":150241,"RBABYTE":100,"UBAFIL":4,"UBABLK":16784411,"UBAREC":42,"UBASQN":133,"ABS_FILE_NUM":4,"REL_FILE_NUM":7,"DATA_BLK_NUM":135,"DATA_OBJ_NUM":73555,"DATA_OBJV_NUM":2,"DATA_OBJD_NUM":73555,"SQL_REDO":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'gold', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:31.000') where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'silver' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.676') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.000') and \"COUNTRY\" IS NULL and ROWID = 'AAAR9TAAHAAAACHAAG';","SQL_UNDO":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'silver', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.000') where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'gold' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:28.676') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:31.000') and \"COUNTRY\" IS NULL and ROWID = 'AAAR9TAAHAAAACHAAG';","RS_ID":" 0x000002.00024ae1.0064 ","SSN":0,"CSF":false,"INFO":null,"STATUS":0,"REDO_VALUE":46,"UNDO_VALUE":47,"SAFE_RESUME_SCN":0,"CSCN":1445257,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":"CDB$ROOT","SRC_CON_ID":1,"SRC_CON_UID":1,"SRC_CON_DBID":0,"SRC_CON_GUID":null,"CON_ID":false}}
# {"schema":{"type":"struct","fields":[{"type":"int64","optional":true,"field":"SCN"},{"type":"int64","optional":true,"field":"START_SCN"},{"type":"int64","optional":true,"field":"COMMIT_SCN"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"START_TIMESTAMP"},{"type":"int64","optional":true,"name":"org.apache.kafka.connect.data.Timestamp","version":1,"field":"COMMIT_TIMESTAMP"},{"type":"int64","optional":true,"field":"XIDUSN"},{"type":"int64","optional":true,"field":"XIDSLT"},{"type":"int64","optional":true,"field":"XIDSQN"},{"type":"bytes","optional":true,"field":"XID"},{"type":"int64","optional":true,"field":"PXIDUSN"},{"type":"int64","optional":true,"field":"PXIDSLT"},{"type":"int64","optional":true,"field":"PXIDSQN"},{"type":"bytes","optional":true,"field":"PXID"},{"type":"string","optional":true,"field":"TX_NAME"},{"type":"string","optional":true,"field":"OPERATION"},{"type":"int8","optional":true,"field":"OPERATION_CODE"},{"type":"boolean","optional":true,"field":"ROLLBACK"},{"type":"string","optional":true,"field":"SEG_OWNER"},{"type":"string","optional":true,"field":"SEG_NAME"},{"type":"string","optional":true,"field":"TABLE_NAME"},{"type":"int8","optional":true,"field":"SEG_TYPE"},{"type":"string","optional":true,"field":"SEG_TYPE_NAME"},{"type":"string","optional":true,"field":"TABLE_SPACE"},{"type":"string","optional":true,"field":"ROW_ID"},{"type":"string","optional":true,"field":"USERNAME"},{"type":"string","optional":true,"field":"OS_USERNAME"},{"type":"string","optional":true,"field":"MACHINE_NAME"},{"type":"int64","optional":true,"field":"AUDIT_SESSIONID"},{"type":"int64","optional":true,"field":"SESSION_NUM"},{"type":"int64","optional":true,"field":"SERIAL_NUM"},{"type":"string","optional":true,"field":"SESSION_INFO"},{"type":"int64","optional":true,"field":"THREAD_NUM"},{"type":"int64","optional":true,"field":"SEQUENCE_NUM"},{"type":"int64","optional":true,"field":"RBASQN"},{"type":"int64","optional":true,"field":"RBABLK"},{"type":"int64","optional":true,"field":"RBABYTE"},{"type":"int64","optional":true,"field":"UBAFIL"},{"type":"int64","optional":true,"field":"UBABLK"},{"type":"int64","optional":true,"field":"UBAREC"},{"type":"int64","optional":true,"field":"UBASQN"},{"type":"int64","optional":true,"field":"ABS_FILE_NUM"},{"type":"int64","optional":true,"field":"REL_FILE_NUM"},{"type":"int64","optional":true,"field":"DATA_BLK_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJ_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJV_NUM"},{"type":"int64","optional":true,"field":"DATA_OBJD_NUM"},{"type":"string","optional":true,"field":"SQL_REDO"},{"type":"string","optional":true,"field":"SQL_UNDO"},{"type":"string","optional":true,"field":"RS_ID"},{"type":"int64","optional":true,"field":"SSN"},{"type":"boolean","optional":true,"field":"CSF"},{"type":"string","optional":true,"field":"INFO"},{"type":"int32","optional":true,"field":"STATUS"},{"type":"int64","optional":true,"field":"REDO_VALUE"},{"type":"int64","optional":true,"field":"UNDO_VALUE"},{"type":"int64","optional":true,"field":"SAFE_RESUME_SCN"},{"type":"int64","optional":true,"field":"CSCN"},{"type":"bytes","optional":true,"field":"OBJECT_ID"},{"type":"string","optional":true,"field":"EDITION_NAME"},{"type":"string","optional":true,"field":"CLIENT_ID"},{"type":"string","optional":true,"field":"SRC_CON_NAME"},{"type":"int64","optional":true,"field":"SRC_CON_ID"},{"type":"int64","optional":true,"field":"SRC_CON_UID"},{"type":"int64","optional":true,"field":"SRC_CON_DBID"},{"type":"bytes","optional":true,"field":"SRC_CON_GUID"},{"type":"boolean","optional":true,"field":"CON_ID"}],"optional":false},"payload":{"SCN":1445256,"START_SCN":1445256,"COMMIT_SCN":1445257,"TIMESTAMP":1631536051000,"START_TIMESTAMP":1631536051000,"COMMIT_TIMESTAMP":1631536051000,"XIDUSN":7,"XIDSLT":16,"XIDSQN":526,"XID":"BwAQAA4CAAA=","PXIDUSN":7,"PXIDSLT":16,"PXIDSQN":526,"PXID":"BwAQAA4CAAA=","TX_NAME":null,"OPERATION":"UPDATE","OPERATION_CODE":3,"ROLLBACK":false,"SEG_OWNER":"C##MYUSER","SEG_NAME":"CUSTOMERS","TABLE_NAME":"CUSTOMERS","SEG_TYPE":2,"SEG_TYPE_NAME":"TABLE","TABLE_SPACE":"USERS","ROW_ID":"AAAR9TAAHAAAACHAAH","USERNAME":"C##MYUSER","OS_USERNAME":"oracle","MACHINE_NAME":"oracle","AUDIT_SESSIONID":80002,"SESSION_NUM":869,"SERIAL_NUM":59836,"SESSION_INFO":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3220 OS_program_name=sqlplus@oracle (TNS V1-V3)","THREAD_NUM":1,"SEQUENCE_NUM":5,"RBASQN":2,"RBABLK":150242,"RBABYTE":344,"UBAFIL":4,"UBABLK":16784411,"UBAREC":44,"UBASQN":133,"ABS_FILE_NUM":4,"REL_FILE_NUM":7,"DATA_BLK_NUM":135,"DATA_OBJ_NUM":73555,"DATA_OBJV_NUM":2,"DATA_OBJD_NUM":73555,"SQL_REDO":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'gold', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:31.000') where \"ID\" = '44' and \"FIRST_NAME\" = 'Josef' and \"LAST_NAME\" = 'K' and \"EMAIL\" = 'jk@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'bronze' and \"COMMENTS\" = 'How is it even possible for someone to be guilty' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.602') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.000') and \"COUNTRY\" = 'Poland' and ROWID = 'AAAR9TAAHAAAACHAAH';","SQL_UNDO":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'bronze', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.000') where \"ID\" = '44' and \"FIRST_NAME\" = 'Josef' and \"LAST_NAME\" = 'K' and \"EMAIL\" = 'jk@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'gold' and \"COMMENTS\" = 'How is it even possible for someone to be guilty' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:30.602') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-13 12:27:31.000') and \"COUNTRY\" = 'Poland' and ROWID = 'AAAR9TAAHAAAACHAAH';","RS_ID":" 0x000002.00024ae2.0158 ","SSN":0,"CSF":false,"INFO":null,"STATUS":0,"REDO_VALUE":50,"UNDO_VALUE":51,"SAFE_RESUME_SCN":0,"CSCN":1445257,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":"CDB$ROOT","SRC_CON_ID":1,"SRC_CON_UID":1,"SRC_CON_DBID":0,"SRC_CON_GUID":null,"CON_ID":false}}
# Processed a total of 9 messages

log "Verifying topic ORCLCDB.C__MYUSER.CUSTOMERS.AVRO: there should be 13 records"
set +e
timeout 60 docker exec connect kafka-avro-console-consumer -bootstrap-server broker:9092 --property schema.registry.url=http://schema-registry:8081 --topic ORCLCDB.C__MYUSER.CUSTOMERS.AVRO --from-beginning --max-messages 13 > /tmp/result.log  2>&1
set -e
cat /tmp/result.log
log "Check there is 5 snapshots events"
if [ $(grep -c "op_type\":{\"string\":\"R\"}" /tmp/result.log) -ne 5 ]
then
     logerror "Did not get expected results"
     exit 1
fi
log "Check there is 3 insert events"
if [ $(grep -c "op_type\":{\"string\":\"I\"}" /tmp/result.log) -ne 3 ]
then
     logerror "Did not get expected results"
     exit 1
fi
log "Check there is 4 update events"
if [ $(grep -c "op_type\":{\"string\":\"U\"}" /tmp/result.log) -ne 4 ]
then
     logerror "Did not get expected results"
     exit 1
fi
log "Check there is 1 delete events"
if [ $(grep -c "op_type\":{\"string\":\"D\"}" /tmp/result.log) -ne 1 ]
then
     logerror "Did not get expected results"
     exit 1
fi

# {"ID":1,"FIRST_NAME":{"string":"Rica"},"LAST_NAME":{"string":"Blaisdell"},"EMAIL":{"string":"rblaisdell0@rambler.ru"},"GENDER":{"string":"Female"},"CLUB_STATUS":{"string":"bronze"},"COMMENTS":{"string":"Universal optimal hierarchy"},"CREATE_TS":{"long":1631604916729},"UPDATE_TS":{"long":1631604916000},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447214"},"op_type":{"string":"R"},"op_ts":null,"current_ts":{"string":"1631604960588"},"row_id":null,"username":null}
# {"ID":2,"FIRST_NAME":{"string":"Ruthie"},"LAST_NAME":{"string":"Brockherst"},"EMAIL":{"string":"rbrockherst1@ow.ly"},"GENDER":{"string":"Female"},"CLUB_STATUS":{"string":"platinum"},"COMMENTS":{"string":"Reverse-engineered tangible interface"},"CREATE_TS":{"long":1631604916734},"UPDATE_TS":{"long":1631604916000},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447214"},"op_type":{"string":"R"},"op_ts":null,"current_ts":{"string":"1631604960588"},"row_id":null,"username":null}
# {"ID":3,"FIRST_NAME":{"string":"Mariejeanne"},"LAST_NAME":{"string":"Cocci"},"EMAIL":{"string":"mcocci2@techcrunch.com"},"GENDER":{"string":"Female"},"CLUB_STATUS":{"string":"bronze"},"COMMENTS":{"string":"Multi-tiered bandwidth-monitored capability"},"CREATE_TS":{"long":1631604916734},"UPDATE_TS":{"long":1631604916000},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447214"},"op_type":{"string":"R"},"op_ts":null,"current_ts":{"string":"1631604960588"},"row_id":null,"username":null}
# {"ID":4,"FIRST_NAME":{"string":"Hashim"},"LAST_NAME":{"string":"Rumke"},"EMAIL":{"string":"hrumke3@sohu.com"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"platinum"},"COMMENTS":{"string":"Self-enabling 24/7 firmware"},"CREATE_TS":{"long":1631604916735},"UPDATE_TS":{"long":1631604916000},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447214"},"op_type":{"string":"R"},"op_ts":null,"current_ts":{"string":"1631604960588"},"row_id":null,"username":null}
# {"ID":5,"FIRST_NAME":{"string":"Hansiain"},"LAST_NAME":{"string":"Coda"},"EMAIL":{"string":"hcoda4@senate.gov"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"platinum"},"COMMENTS":{"string":"Centralized full-range approach"},"CREATE_TS":{"long":1631604916736},"UPDATE_TS":{"long":1631604916000},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447214"},"op_type":{"string":"R"},"op_ts":null,"current_ts":{"string":"1631604960588"},"row_id":null,"username":null}
# {"ID":42,"FIRST_NAME":{"string":"Frantz"},"LAST_NAME":{"string":"Kafka"},"EMAIL":{"string":"fkafka@confluent.io"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"bronze"},"COMMENTS":{"string":"Evil is whatever distracts"},"CREATE_TS":{"long":1631605006478},"UPDATE_TS":{"long":1631605006000},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447326"},"op_type":{"string":"I"},"op_ts":{"string":"1631605006000"},"current_ts":{"string":"1631605008925"},"row_id":{"string":"AAAR9JAAHAAAACFAAA"},"username":{"string":"C##MYUSER"}}
# {"ID":43,"FIRST_NAME":{"string":"Gregor"},"LAST_NAME":{"string":"Samsa"},"EMAIL":{"string":"gsamsa@confluent.io"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"platinium"},"COMMENTS":{"string":"How about if I sleep a little bit longer and forget all this nonsense"},"CREATE_TS":{"long":1631605006481},"UPDATE_TS":{"long":1631605006000},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447326"},"op_type":{"string":"I"},"op_ts":{"string":"1631605006000"},"current_ts":{"string":"1631605008929"},"row_id":{"string":"AAAR9JAAHAAAACFAAB"},"username":{"string":"C##MYUSER"}}
# {"ID":42,"FIRST_NAME":{"string":"Frantz"},"LAST_NAME":{"string":"Kafka"},"EMAIL":{"string":"fkafka@confluent.io"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"gold"},"COMMENTS":{"string":"Evil is whatever distracts"},"CREATE_TS":{"long":1631605006478},"UPDATE_TS":{"long":1631605007000},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447335"},"op_type":{"string":"U"},"op_ts":{"string":"1631605007000"},"current_ts":{"string":"1631605008945"},"row_id":{"string":"AAAR9JAAHAAAACFAAA"},"username":{"string":"C##MYUSER"}}
# {"ID":42,"FIRST_NAME":{"string":"Frantz"},"LAST_NAME":{"string":"Kafka"},"EMAIL":{"string":"fkafka@confluent.io"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"gold"},"COMMENTS":{"string":"Evil is whatever distracts"},"CREATE_TS":{"long":1631605006478},"UPDATE_TS":{"long":1631605007000},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447342"},"op_type":{"string":"D"},"op_ts":{"string":"1631605007000"},"current_ts":{"string":"1631605008950"},"row_id":{"string":"AAAR9JAAHAAAACFAAA"},"username":{"string":"C##MYUSER"}}
# {"ID":62,"FIRST_NAME":{"string":"Josef"},"LAST_NAME":{"string":"K"},"EMAIL":{"string":"jk@confluent.io"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"bronze"},"COMMENTS":{"string":"How is it even possible for someone to be guilty"},"CREATE_TS":{"long":1631605008583},"UPDATE_TS":{"long":1631605008000},"COUNTRY":{"string":"Poland"},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447366"},"op_type":{"string":"I"},"op_ts":{"string":"1631605008000"},"current_ts":{"string":"1631605008958"},"row_id":{"string":"AAAR9JAAHAAAACFAAC"},"username":{"string":"C##MYUSER"}}
# {"ID":43,"FIRST_NAME":{"string":"Gregor"},"LAST_NAME":{"string":"Samsa"},"EMAIL":{"string":"gsamsa@confluent.io"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"silver"},"COMMENTS":{"string":"How about if I sleep a little bit longer and forget all this nonsense"},"CREATE_TS":{"long":1631605006481},"UPDATE_TS":{"long":1631605008000},"COUNTRY":null,"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447367"},"op_type":{"string":"U"},"op_ts":{"string":"1631605008000"},"current_ts":{"string":"1631605008963"},"row_id":{"string":"AAAR9JAAHAAAACFAAB"},"username":{"string":"C##MYUSER"}}
# {"ID":43,"FIRST_NAME":{"string":"Gregor"},"LAST_NAME":{"string":"Samsa"},"EMAIL":{"string":"gsamsa@confluent.io"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"gold"},"COMMENTS":{"string":"How about if I sleep a little bit longer and forget all this nonsense"},"CREATE_TS":{"long":1631605006481},"UPDATE_TS":{"long":1631605009000},"COUNTRY":null,"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447374"},"op_type":{"string":"U"},"op_ts":{"string":"1631605009000"},"current_ts":{"string":"1631605038830"},"row_id":{"string":"AAAR9JAAHAAAACFAAB"},"username":{"string":"C##MYUSER"}}
# {"ID":62,"FIRST_NAME":{"string":"Josef"},"LAST_NAME":{"string":"K"},"EMAIL":{"string":"jk@confluent.io"},"GENDER":{"string":"Male"},"CLUB_STATUS":{"string":"gold"},"COMMENTS":{"string":"How is it even possible for someone to be guilty"},"CREATE_TS":{"long":1631605008583},"UPDATE_TS":{"long":1631605009000},"COUNTRY":{"string":"Poland"},"table":{"string":"ORCLCDB.C##MYUSER.CUSTOMERS"},"scn":{"string":"1447374"},"op_type":{"string":"U"},"op_ts":{"string":"1631605009000"},"current_ts":{"string":"1631605038832"},"row_id":{"string":"AAAR9JAAHAAAACFAAC"},"username":{"string":"C##MYUSER"}}

log "Verifying topic redo-log-topic-avro: there should be 9 records"
timeout 60 docker exec connect kafka-avro-console-consumer -bootstrap-server broker:9092 --property schema.registry.url=http://schema-registry:8081 --topic redo-log-topic-avro --from-beginning --max-messages 9

# {"SCN":{"long":1447326},"START_SCN":{"long":1447326},"COMMIT_SCN":{"long":1447327},"TIMESTAMP":{"long":1631605006000},"START_TIMESTAMP":{"long":1631605006000},"COMMIT_TIMESTAMP":{"long":1631605006000},"XIDUSN":{"long":6},"XIDSLT":{"long":14},"XIDSQN":{"long":712},"XID":{"bytes":"\u0006\u0000\u000E\u0000\u0002\u0000\u0000"},"PXIDUSN":{"long":6},"PXIDSLT":{"long":14},"PXIDSQN":{"long":712},"PXID":{"bytes":"\u0006\u0000\u000E\u0000\u0002\u0000\u0000"},"TX_NAME":null,"OPERATION":{"string":"INSERT"},"OPERATION_CODE":{"int":1},"ROLLBACK":{"boolean":false},"SEG_OWNER":{"string":"C##MYUSER"},"SEG_NAME":{"string":"CUSTOMERS"},"TABLE_NAME":{"string":"CUSTOMERS"},"SEG_TYPE":{"int":2},"SEG_TYPE_NAME":{"string":"TABLE"},"TABLE_SPACE":{"string":"USERS"},"ROW_ID":{"string":"AAAR9JAAHAAAACFAAA"},"USERNAME":{"string":"C##MYUSER"},"OS_USERNAME":{"string":"oracle"},"MACHINE_NAME":{"string":"oracle"},"AUDIT_SESSIONID":{"long":80001},"SESSION_NUM":{"long":252},"SERIAL_NUM":{"long":21272},"SESSION_INFO":{"string":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3206 OS_program_name=sqlplus@oracle (TNS V1-V3)"},"THREAD_NUM":{"long":1},"SEQUENCE_NUM":{"long":2},"RBASQN":{"long":2},"RBABLK":{"long":152131},"RBABYTE":{"long":16},"UBAFIL":{"long":4},"UBABLK":{"long":16785410},"UBAREC":{"long":47},"UBASQN":{"long":223},"ABS_FILE_NUM":{"long":7},"REL_FILE_NUM":{"long":7},"DATA_BLK_NUM":{"long":133},"DATA_OBJ_NUM":{"long":73545},"DATA_OBJV_NUM":{"long":1},"DATA_OBJD_NUM":{"long":73545},"SQL_REDO":{"string":"insert into \"C##MYUSER\".\"CUSTOMERS\"(\"ID\",\"FIRST_NAME\",\"LAST_NAME\",\"EMAIL\",\"GENDER\",\"CLUB_STATUS\",\"COMMENTS\",\"CREATE_TS\",\"UPDATE_TS\") values ('42','Frantz','Kafka','fkafka@confluent.io','Male','bronze','Evil is whatever distracts',TO_TIMESTAMP('2021-09-14 07:36:46.478'),TO_TIMESTAMP('2021-09-14 07:36:46.000'));"},"SQL_UNDO":{"string":"delete from \"C##MYUSER\".\"CUSTOMERS\" where \"ID\" = '42' and \"FIRST_NAME\" = 'Frantz' and \"LAST_NAME\" = 'Kafka' and \"EMAIL\" = 'fkafka@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'bronze' and \"COMMENTS\" = 'Evil is whatever distracts' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.478') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.000') and ROWID = 'AAAR9JAAHAAAACFAAA';"},"RS_ID":{"string":" 0x000002.00025243.0010 "},"SSN":{"long":0},"CSF":{"boolean":false},"INFO":null,"STATUS":{"int":0},"REDO_VALUE":{"long":344},"UNDO_VALUE":{"long":345},"SAFE_RESUME_SCN":{"long":0},"CSCN":{"long":1447327},"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":{"string":"CDB$ROOT"},"SRC_CON_ID":{"long":1},"SRC_CON_UID":{"long":1},"SRC_CON_DBID":{"long":0},"SRC_CON_GUID":null,"CON_ID":{"boolean":false}}
# {"SCN":{"long":1447326},"START_SCN":{"long":1447326},"COMMIT_SCN":{"long":1447327},"TIMESTAMP":{"long":1631605006000},"START_TIMESTAMP":{"long":1631605006000},"COMMIT_TIMESTAMP":{"long":1631605006000},"XIDUSN":{"long":6},"XIDSLT":{"long":14},"XIDSQN":{"long":712},"XID":{"bytes":"\u0006\u0000\u000E\u0000\u0002\u0000\u0000"},"PXIDUSN":{"long":6},"PXIDSLT":{"long":14},"PXIDSQN":{"long":712},"PXID":{"bytes":"\u0006\u0000\u000E\u0000\u0002\u0000\u0000"},"TX_NAME":null,"OPERATION":{"string":"INSERT"},"OPERATION_CODE":{"int":1},"ROLLBACK":{"boolean":false},"SEG_OWNER":{"string":"C##MYUSER"},"SEG_NAME":{"string":"CUSTOMERS"},"TABLE_NAME":{"string":"CUSTOMERS"},"SEG_TYPE":{"int":2},"SEG_TYPE_NAME":{"string":"TABLE"},"TABLE_SPACE":{"string":"USERS"},"ROW_ID":{"string":"AAAR9JAAHAAAACFAAB"},"USERNAME":{"string":"C##MYUSER"},"OS_USERNAME":{"string":"oracle"},"MACHINE_NAME":{"string":"oracle"},"AUDIT_SESSIONID":{"long":80001},"SESSION_NUM":{"long":252},"SERIAL_NUM":{"long":21272},"SESSION_INFO":{"string":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3206 OS_program_name=sqlplus@oracle (TNS V1-V3)"},"THREAD_NUM":{"long":1},"SEQUENCE_NUM":{"long":3},"RBASQN":{"long":2},"RBABLK":{"long":152132},"RBABYTE":{"long":472},"UBAFIL":{"long":4},"UBABLK":{"long":16785410},"UBAREC":{"long":49},"UBASQN":{"long":223},"ABS_FILE_NUM":{"long":7},"REL_FILE_NUM":{"long":7},"DATA_BLK_NUM":{"long":133},"DATA_OBJ_NUM":{"long":73545},"DATA_OBJV_NUM":{"long":1},"DATA_OBJD_NUM":{"long":73545},"SQL_REDO":{"string":"insert into \"C##MYUSER\".\"CUSTOMERS\"(\"ID\",\"FIRST_NAME\",\"LAST_NAME\",\"EMAIL\",\"GENDER\",\"CLUB_STATUS\",\"COMMENTS\",\"CREATE_TS\",\"UPDATE_TS\") values ('43','Gregor','Samsa','gsamsa@confluent.io','Male','platinium','How about if I sleep a little bit longer and forget all this nonsense',TO_TIMESTAMP('2021-09-14 07:36:46.481'),TO_TIMESTAMP('2021-09-14 07:36:46.000'));"},"SQL_UNDO":{"string":"delete from \"C##MYUSER\".\"CUSTOMERS\" where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'platinium' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.481') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.000') and ROWID = 'AAAR9JAAHAAAACFAAB';"},"RS_ID":{"string":" 0x000002.00025244.01d8 "},"SSN":{"long":1},"CSF":{"boolean":false},"INFO":null,"STATUS":{"int":0},"REDO_VALUE":{"long":346},"UNDO_VALUE":{"long":347},"SAFE_RESUME_SCN":{"long":0},"CSCN":{"long":1447327},"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":{"string":"CDB$ROOT"},"SRC_CON_ID":{"long":1},"SRC_CON_UID":{"long":1},"SRC_CON_DBID":{"long":0},"SRC_CON_GUID":null,"CON_ID":{"boolean":false}}
# {"SCN":{"long":1447335},"START_SCN":{"long":1447335},"COMMIT_SCN":{"long":1447336},"TIMESTAMP":{"long":1631605007000},"START_TIMESTAMP":{"long":1631605007000},"COMMIT_TIMESTAMP":{"long":1631605007000},"XIDUSN":{"long":9},"XIDSLT":{"long":10},"XIDSQN":{"long":735},"XID":{"bytes":"\t\u0000\n\u0000\u0002\u0000\u0000"},"PXIDUSN":{"long":9},"PXIDSLT":{"long":10},"PXIDSQN":{"long":735},"PXID":{"bytes":"\t\u0000\n\u0000\u0002\u0000\u0000"},"TX_NAME":null,"OPERATION":{"string":"UPDATE"},"OPERATION_CODE":{"int":3},"ROLLBACK":{"boolean":false},"SEG_OWNER":{"string":"C##MYUSER"},"SEG_NAME":{"string":"CUSTOMERS"},"TABLE_NAME":{"string":"CUSTOMERS"},"SEG_TYPE":{"int":2},"SEG_TYPE_NAME":{"string":"TABLE"},"TABLE_SPACE":{"string":"USERS"},"ROW_ID":{"string":"AAAR9JAAHAAAACFAAA"},"USERNAME":{"string":"C##MYUSER"},"OS_USERNAME":{"string":"oracle"},"MACHINE_NAME":{"string":"oracle"},"AUDIT_SESSIONID":{"long":90001},"SESSION_NUM":{"long":252},"SERIAL_NUM":{"long":37063},"SESSION_INFO":{"string":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3213 OS_program_name=sqlplus@oracle (TNS V1-V3)"},"THREAD_NUM":{"long":1},"SEQUENCE_NUM":{"long":3},"RBASQN":{"long":2},"RBABLK":{"long":152144},"RBABYTE":{"long":68},"UBAFIL":{"long":4},"UBABLK":{"long":16782200},"UBAREC":{"long":20},"UBASQN":{"long":236},"ABS_FILE_NUM":{"long":4},"REL_FILE_NUM":{"long":7},"DATA_BLK_NUM":{"long":133},"DATA_OBJ_NUM":{"long":73545},"DATA_OBJV_NUM":{"long":1},"DATA_OBJD_NUM":{"long":73545},"SQL_REDO":{"string":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'gold', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:47.000') where \"ID\" = '42' and \"FIRST_NAME\" = 'Frantz' and \"LAST_NAME\" = 'Kafka' and \"EMAIL\" = 'fkafka@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'bronze' and \"COMMENTS\" = 'Evil is whatever distracts' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.478') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.000') and ROWID = 'AAAR9JAAHAAAACFAAA';"},"SQL_UNDO":{"string":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'bronze', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.000') where \"ID\" = '42' and \"FIRST_NAME\" = 'Frantz' and \"LAST_NAME\" = 'Kafka' and \"EMAIL\" = 'fkafka@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'gold' and \"COMMENTS\" = 'Evil is whatever distracts' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.478') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:47.000') and ROWID = 'AAAR9JAAHAAAACFAAA';"},"RS_ID":{"string":" 0x000002.00025250.0044 "},"SSN":{"long":0},"CSF":{"boolean":false},"INFO":null,"STATUS":{"int":0},"REDO_VALUE":{"long":366},"UNDO_VALUE":{"long":367},"SAFE_RESUME_SCN":{"long":0},"CSCN":{"long":1447336},"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":{"string":"CDB$ROOT"},"SRC_CON_ID":{"long":1},"SRC_CON_UID":{"long":1},"SRC_CON_DBID":{"long":0},"SRC_CON_GUID":null,"CON_ID":{"boolean":false}}
# {"SCN":{"long":1447342},"START_SCN":{"long":1447342},"COMMIT_SCN":{"long":1447343},"TIMESTAMP":{"long":1631605007000},"START_TIMESTAMP":{"long":1631605007000},"COMMIT_TIMESTAMP":{"long":1631605007000},"XIDUSN":{"long":2},"XIDSLT":{"long":4},"XIDSQN":{"long":709},"XID":{"bytes":"\u0002\u0000\u0004\u0000\u0002\u0000\u0000"},"PXIDUSN":{"long":2},"PXIDSLT":{"long":4},"PXIDSQN":{"long":709},"PXID":{"bytes":"\u0002\u0000\u0004\u0000\u0002\u0000\u0000"},"TX_NAME":null,"OPERATION":{"string":"DELETE"},"OPERATION_CODE":{"int":2},"ROLLBACK":{"boolean":false},"SEG_OWNER":{"string":"C##MYUSER"},"SEG_NAME":{"string":"CUSTOMERS"},"TABLE_NAME":{"string":"CUSTOMERS"},"SEG_TYPE":{"int":2},"SEG_TYPE_NAME":{"string":"TABLE"},"TABLE_SPACE":{"string":"USERS"},"ROW_ID":{"string":"AAAR9JAAHAAAACFAAA"},"USERNAME":{"string":"C##MYUSER"},"OS_USERNAME":{"string":"oracle"},"MACHINE_NAME":{"string":"oracle"},"AUDIT_SESSIONID":{"long":90002},"SESSION_NUM":{"long":252},"SERIAL_NUM":{"long":48313},"SESSION_INFO":{"string":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3221 OS_program_name=sqlplus@oracle (TNS V1-V3)"},"THREAD_NUM":{"long":1},"SEQUENCE_NUM":{"long":2},"RBASQN":{"long":2},"RBABLK":{"long":152150},"RBABYTE":{"long":16},"UBAFIL":{"long":4},"UBABLK":{"long":0},"UBAREC":{"long":0},"UBASQN":{"long":0},"ABS_FILE_NUM":{"long":4},"REL_FILE_NUM":{"long":7},"DATA_BLK_NUM":{"long":133},"DATA_OBJ_NUM":{"long":73545},"DATA_OBJV_NUM":{"long":1},"DATA_OBJD_NUM":{"long":73545},"SQL_REDO":{"string":"delete from \"C##MYUSER\".\"CUSTOMERS\" where \"ID\" = '42' and \"FIRST_NAME\" = 'Frantz' and \"LAST_NAME\" = 'Kafka' and \"EMAIL\" = 'fkafka@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'gold' and \"COMMENTS\" = 'Evil is whatever distracts' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.478') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:47.000') and ROWID = 'AAAR9JAAHAAAACFAAA';"},"SQL_UNDO":{"string":"insert into \"C##MYUSER\".\"CUSTOMERS\"(\"ID\",\"FIRST_NAME\",\"LAST_NAME\",\"EMAIL\",\"GENDER\",\"CLUB_STATUS\",\"COMMENTS\",\"CREATE_TS\",\"UPDATE_TS\") values ('42','Frantz','Kafka','fkafka@confluent.io','Male','gold','Evil is whatever distracts',TO_TIMESTAMP('2021-09-14 07:36:46.478'),TO_TIMESTAMP('2021-09-14 07:36:47.000'));"},"RS_ID":{"string":" 0x000002.00025256.0010 "},"SSN":{"long":0},"CSF":{"boolean":false},"INFO":null,"STATUS":{"int":0},"REDO_VALUE":{"long":378},"UNDO_VALUE":{"long":379},"SAFE_RESUME_SCN":{"long":0},"CSCN":{"long":1447343},"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":{"string":"CDB$ROOT"},"SRC_CON_ID":{"long":1},"SRC_CON_UID":{"long":1},"SRC_CON_DBID":{"long":0},"SRC_CON_GUID":null,"CON_ID":{"boolean":false}}
# {"SCN":{"long":1447353},"START_SCN":null,"COMMIT_SCN":null,"TIMESTAMP":{"long":1631605008000},"START_TIMESTAMP":null,"COMMIT_TIMESTAMP":null,"XIDUSN":{"long":4},"XIDSLT":{"long":2},"XIDSQN":{"long":522},"XID":{"bytes":"\u0004\u0000\u0002\u0000\n\u0002\u0000\u0000"},"PXIDUSN":{"long":4},"PXIDSLT":{"long":2},"PXIDSQN":{"long":522},"PXID":{"bytes":"\u0004\u0000\u0002\u0000\n\u0002\u0000\u0000"},"TX_NAME":null,"OPERATION":{"string":"DDL"},"OPERATION_CODE":{"int":5},"ROLLBACK":{"boolean":false},"SEG_OWNER":{"string":"C##MYUSER"},"SEG_NAME":{"string":"CUSTOMERS"},"TABLE_NAME":{"string":"CUSTOMERS"},"SEG_TYPE":{"int":2},"SEG_TYPE_NAME":{"string":"TABLE"},"TABLE_SPACE":null,"ROW_ID":{"string":"AAAAAAAAAAAAAAAAAB"},"USERNAME":{"string":"C##MYUSER"},"OS_USERNAME":{"string":"oracle"},"MACHINE_NAME":{"string":"oracle"},"AUDIT_SESSIONID":{"long":90003},"SESSION_NUM":{"long":252},"SERIAL_NUM":{"long":50473},"SESSION_INFO":{"string":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3228 OS_program_name=sqlplus@oracle (TNS V1-V3)"},"THREAD_NUM":{"long":1},"SEQUENCE_NUM":{"long":4},"RBASQN":{"long":2},"RBABLK":{"long":152160},"RBABYTE":{"long":200},"UBAFIL":{"long":4},"UBABLK":{"long":0},"UBAREC":{"long":0},"UBASQN":{"long":0},"ABS_FILE_NUM":{"long":0},"REL_FILE_NUM":{"long":0},"DATA_BLK_NUM":{"long":0},"DATA_OBJ_NUM":{"long":73545},"DATA_OBJV_NUM":{"long":2},"DATA_OBJD_NUM":{"long":0},"SQL_REDO":{"string":"  alter table CUSTOMERS add (\n    country VARCHAR(50)\n  );"},"SQL_UNDO":null,"RS_ID":{"string":" 0x000002.00025260.00c8 "},"SSN":{"long":0},"CSF":{"boolean":false},"INFO":{"string":"USER DDL (PlSql=0 RecDep=0)"},"STATUS":{"int":0},"REDO_VALUE":{"long":394},"UNDO_VALUE":{"long":395},"SAFE_RESUME_SCN":null,"CSCN":null,"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":{"string":"CDB$ROOT"},"SRC_CON_ID":{"long":1},"SRC_CON_UID":{"long":1},"SRC_CON_DBID":{"long":0},"SRC_CON_GUID":null,"CON_ID":{"boolean":false}}
# {"SCN":{"long":1447366},"START_SCN":{"long":1447366},"COMMIT_SCN":{"long":1447368},"TIMESTAMP":{"long":1631605008000},"START_TIMESTAMP":{"long":1631605008000},"COMMIT_TIMESTAMP":{"long":1631605008000},"XIDUSN":{"long":9},"XIDSLT":{"long":14},"XIDSQN":{"long":735},"XID":{"bytes":"\t\u0000\u000E\u0000\u0002\u0000\u0000"},"PXIDUSN":{"long":9},"PXIDSLT":{"long":14},"PXIDSQN":{"long":735},"PXID":{"bytes":"\t\u0000\u000E\u0000\u0002\u0000\u0000"},"TX_NAME":null,"OPERATION":{"string":"INSERT"},"OPERATION_CODE":{"int":1},"ROLLBACK":{"boolean":false},"SEG_OWNER":{"string":"C##MYUSER"},"SEG_NAME":{"string":"CUSTOMERS"},"TABLE_NAME":{"string":"CUSTOMERS"},"SEG_TYPE":{"int":2},"SEG_TYPE_NAME":{"string":"TABLE"},"TABLE_SPACE":{"string":"USERS"},"ROW_ID":{"string":"AAAR9JAAHAAAACFAAC"},"USERNAME":{"string":"C##MYUSER"},"OS_USERNAME":{"string":"oracle"},"MACHINE_NAME":{"string":"oracle"},"AUDIT_SESSIONID":{"long":100001},"SESSION_NUM":{"long":252},"SERIAL_NUM":{"long":44994},"SESSION_INFO":{"string":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3235 OS_program_name=sqlplus@oracle (TNS V1-V3)"},"THREAD_NUM":{"long":1},"SEQUENCE_NUM":{"long":2},"RBASQN":{"long":2},"RBABLK":{"long":152179},"RBABYTE":{"long":16},"UBAFIL":{"long":4},"UBABLK":{"long":16782200},"UBAREC":{"long":22},"UBASQN":{"long":236},"ABS_FILE_NUM":{"long":7},"REL_FILE_NUM":{"long":7},"DATA_BLK_NUM":{"long":133},"DATA_OBJ_NUM":{"long":73545},"DATA_OBJV_NUM":{"long":2},"DATA_OBJD_NUM":{"long":73545},"SQL_REDO":{"string":"insert into \"C##MYUSER\".\"CUSTOMERS\"(\"ID\",\"FIRST_NAME\",\"LAST_NAME\",\"EMAIL\",\"GENDER\",\"CLUB_STATUS\",\"COMMENTS\",\"CREATE_TS\",\"UPDATE_TS\",\"COUNTRY\") values ('62','Josef','K','jk@confluent.io','Male','bronze','How is it even possible for someone to be guilty',TO_TIMESTAMP('2021-09-14 07:36:48.583'),TO_TIMESTAMP('2021-09-14 07:36:48.000'),'Poland');"},"SQL_UNDO":{"string":"delete from \"C##MYUSER\".\"CUSTOMERS\" where \"ID\" = '62' and \"FIRST_NAME\" = 'Josef' and \"LAST_NAME\" = 'K' and \"EMAIL\" = 'jk@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'bronze' and \"COMMENTS\" = 'How is it even possible for someone to be guilty' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.583') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.000') and \"COUNTRY\" = 'Poland' and ROWID = 'AAAR9JAAHAAAACFAAC';"},"RS_ID":{"string":" 0x000002.00025273.0010 "},"SSN":{"long":2},"CSF":{"boolean":false},"INFO":null,"STATUS":{"int":0},"REDO_VALUE":{"long":34},"UNDO_VALUE":{"long":35},"SAFE_RESUME_SCN":{"long":0},"CSCN":{"long":1447368},"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":{"string":"CDB$ROOT"},"SRC_CON_ID":{"long":1},"SRC_CON_UID":{"long":1},"SRC_CON_DBID":{"long":0},"SRC_CON_GUID":null,"CON_ID":{"boolean":false}}
# {"SCN":{"long":1447367},"START_SCN":{"long":1447366},"COMMIT_SCN":{"long":1447368},"TIMESTAMP":{"long":1631605008000},"START_TIMESTAMP":{"long":1631605008000},"COMMIT_TIMESTAMP":{"long":1631605008000},"XIDUSN":{"long":9},"XIDSLT":{"long":14},"XIDSQN":{"long":735},"XID":{"bytes":"\t\u0000\u000E\u0000\u0002\u0000\u0000"},"PXIDUSN":{"long":9},"PXIDSLT":{"long":14},"PXIDSQN":{"long":735},"PXID":{"bytes":"\t\u0000\u000E\u0000\u0002\u0000\u0000"},"TX_NAME":null,"OPERATION":{"string":"UPDATE"},"OPERATION_CODE":{"int":3},"ROLLBACK":{"boolean":false},"SEG_OWNER":{"string":"C##MYUSER"},"SEG_NAME":{"string":"CUSTOMERS"},"TABLE_NAME":{"string":"CUSTOMERS"},"SEG_TYPE":{"int":2},"SEG_TYPE_NAME":{"string":"TABLE"},"TABLE_SPACE":{"string":"USERS"},"ROW_ID":{"string":"AAAR9JAAHAAAACFAAB"},"USERNAME":{"string":"C##MYUSER"},"OS_USERNAME":{"string":"oracle"},"MACHINE_NAME":{"string":"oracle"},"AUDIT_SESSIONID":{"long":100001},"SESSION_NUM":{"long":252},"SERIAL_NUM":{"long":44994},"SESSION_INFO":{"string":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3235 OS_program_name=sqlplus@oracle (TNS V1-V3)"},"THREAD_NUM":{"long":1},"SEQUENCE_NUM":{"long":4},"RBASQN":{"long":2},"RBABLK":{"long":152184},"RBABYTE":{"long":28},"UBAFIL":{"long":4},"UBABLK":{"long":16782200},"UBAREC":{"long":24},"UBASQN":{"long":236},"ABS_FILE_NUM":{"long":4},"REL_FILE_NUM":{"long":7},"DATA_BLK_NUM":{"long":133},"DATA_OBJ_NUM":{"long":73545},"DATA_OBJV_NUM":{"long":2},"DATA_OBJD_NUM":{"long":73545},"SQL_REDO":{"string":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'silver', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.000') where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'platinium' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.481') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.000') and \"COUNTRY\" IS NULL and ROWID = 'AAAR9JAAHAAAACFAAB';"},"SQL_UNDO":{"string":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'platinium', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.000') where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'silver' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.481') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.000') and \"COUNTRY\" IS NULL and ROWID = 'AAAR9JAAHAAAACFAAB';"},"RS_ID":{"string":" 0x000002.00025278.001c "},"SSN":{"long":0},"CSF":{"boolean":false},"INFO":null,"STATUS":{"int":0},"REDO_VALUE":{"long":38},"UNDO_VALUE":{"long":39},"SAFE_RESUME_SCN":{"long":0},"CSCN":{"long":1447368},"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":{"string":"CDB$ROOT"},"SRC_CON_ID":{"long":1},"SRC_CON_UID":{"long":1},"SRC_CON_DBID":{"long":0},"SRC_CON_GUID":null,"CON_ID":{"boolean":false}}
# {"SCN":{"long":1447374},"START_SCN":{"long":1447374},"COMMIT_SCN":{"long":1447375},"TIMESTAMP":{"long":1631605009000},"START_TIMESTAMP":{"long":1631605009000},"COMMIT_TIMESTAMP":{"long":1631605009000},"XIDUSN":{"long":9},"XIDSLT":{"long":16},"XIDSQN":{"long":735},"XID":{"bytes":"\t\u0000\u0010\u0000\u0002\u0000\u0000"},"PXIDUSN":{"long":9},"PXIDSLT":{"long":16},"PXIDSQN":{"long":735},"PXID":{"bytes":"\t\u0000\u0010\u0000\u0002\u0000\u0000"},"TX_NAME":null,"OPERATION":{"string":"UPDATE"},"OPERATION_CODE":{"int":3},"ROLLBACK":{"boolean":false},"SEG_OWNER":{"string":"C##MYUSER"},"SEG_NAME":{"string":"CUSTOMERS"},"TABLE_NAME":{"string":"CUSTOMERS"},"SEG_TYPE":{"int":2},"SEG_TYPE_NAME":{"string":"TABLE"},"TABLE_SPACE":{"string":"USERS"},"ROW_ID":{"string":"AAAR9JAAHAAAACFAAB"},"USERNAME":{"string":"C##MYUSER"},"OS_USERNAME":{"string":"oracle"},"MACHINE_NAME":{"string":"oracle"},"AUDIT_SESSIONID":{"long":100002},"SESSION_NUM":{"long":252},"SERIAL_NUM":{"long":47615},"SESSION_INFO":{"string":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3242 OS_program_name=sqlplus@oracle (TNS V1-V3)"},"THREAD_NUM":{"long":1},"SEQUENCE_NUM":{"long":3},"RBASQN":{"long":2},"RBABLK":{"long":152191},"RBABYTE":{"long":100},"UBAFIL":{"long":4},"UBABLK":{"long":16782201},"UBAREC":{"long":3},"UBASQN":{"long":236},"ABS_FILE_NUM":{"long":4},"REL_FILE_NUM":{"long":7},"DATA_BLK_NUM":{"long":133},"DATA_OBJ_NUM":{"long":73545},"DATA_OBJV_NUM":{"long":2},"DATA_OBJD_NUM":{"long":73545},"SQL_REDO":{"string":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'gold', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:49.000') where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'silver' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.481') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.000') and \"COUNTRY\" IS NULL and ROWID = 'AAAR9JAAHAAAACFAAB';"},"SQL_UNDO":{"string":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'silver', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.000') where \"ID\" = '43' and \"FIRST_NAME\" = 'Gregor' and \"LAST_NAME\" = 'Samsa' and \"EMAIL\" = 'gsamsa@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'gold' and \"COMMENTS\" = 'How about if I sleep a little bit longer and forget all this nonsense' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:46.481') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:49.000') and \"COUNTRY\" IS NULL and ROWID = 'AAAR9JAAHAAAACFAAB';"},"RS_ID":{"string":" 0x000002.0002527f.0064 "},"SSN":{"long":0},"CSF":{"boolean":false},"INFO":null,"STATUS":{"int":0},"REDO_VALUE":{"long":52},"UNDO_VALUE":{"long":53},"SAFE_RESUME_SCN":{"long":0},"CSCN":{"long":1447375},"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":{"string":"CDB$ROOT"},"SRC_CON_ID":{"long":1},"SRC_CON_UID":{"long":1},"SRC_CON_DBID":{"long":0},"SRC_CON_GUID":null,"CON_ID":{"boolean":false}}
# {"SCN":{"long":1447374},"START_SCN":{"long":1447374},"COMMIT_SCN":{"long":1447375},"TIMESTAMP":{"long":1631605009000},"START_TIMESTAMP":{"long":1631605009000},"COMMIT_TIMESTAMP":{"long":1631605009000},"XIDUSN":{"long":9},"XIDSLT":{"long":16},"XIDSQN":{"long":735},"XID":{"bytes":"\t\u0000\u0010\u0000\u0002\u0000\u0000"},"PXIDUSN":{"long":9},"PXIDSLT":{"long":16},"PXIDSQN":{"long":735},"PXID":{"bytes":"\t\u0000\u0010\u0000\u0002\u0000\u0000"},"TX_NAME":null,"OPERATION":{"string":"UPDATE"},"OPERATION_CODE":{"int":3},"ROLLBACK":{"boolean":false},"SEG_OWNER":{"string":"C##MYUSER"},"SEG_NAME":{"string":"CUSTOMERS"},"TABLE_NAME":{"string":"CUSTOMERS"},"SEG_TYPE":{"int":2},"SEG_TYPE_NAME":{"string":"TABLE"},"TABLE_SPACE":{"string":"USERS"},"ROW_ID":{"string":"AAAR9JAAHAAAACFAAC"},"USERNAME":{"string":"C##MYUSER"},"OS_USERNAME":{"string":"oracle"},"MACHINE_NAME":{"string":"oracle"},"AUDIT_SESSIONID":{"long":100002},"SESSION_NUM":{"long":252},"SERIAL_NUM":{"long":47615},"SESSION_INFO":{"string":"login_username=C##MYUSER client_info= OS_username=oracle Machine_name=oracle OS_terminal= OS_process_id=3242 OS_program_name=sqlplus@oracle (TNS V1-V3)"},"THREAD_NUM":{"long":1},"SEQUENCE_NUM":{"long":5},"RBASQN":{"long":2},"RBABLK":{"long":152192},"RBABYTE":{"long":344},"UBAFIL":{"long":4},"UBABLK":{"long":16782201},"UBAREC":{"long":5},"UBASQN":{"long":236},"ABS_FILE_NUM":{"long":4},"REL_FILE_NUM":{"long":7},"DATA_BLK_NUM":{"long":133},"DATA_OBJ_NUM":{"long":73545},"DATA_OBJV_NUM":{"long":2},"DATA_OBJD_NUM":{"long":73545},"SQL_REDO":{"string":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'gold', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:49.000') where \"ID\" = '62' and \"FIRST_NAME\" = 'Josef' and \"LAST_NAME\" = 'K' and \"EMAIL\" = 'jk@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'bronze' and \"COMMENTS\" = 'How is it even possible for someone to be guilty' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.583') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.000') and \"COUNTRY\" = 'Poland' and ROWID = 'AAAR9JAAHAAAACFAAC';"},"SQL_UNDO":{"string":"update \"C##MYUSER\".\"CUSTOMERS\" set \"CLUB_STATUS\" = 'bronze', \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.000') where \"ID\" = '62' and \"FIRST_NAME\" = 'Josef' and \"LAST_NAME\" = 'K' and \"EMAIL\" = 'jk@confluent.io' and \"GENDER\" = 'Male' and \"CLUB_STATUS\" = 'gold' and \"COMMENTS\" = 'How is it even possible for someone to be guilty' and \"CREATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:48.583') and \"UPDATE_TS\" = TO_TIMESTAMP('2021-09-14 07:36:49.000') and \"COUNTRY\" = 'Poland' and ROWID = 'AAAR9JAAHAAAACFAAC';"},"RS_ID":{"string":" 0x000002.00025280.0158 "},"SSN":{"long":0},"CSF":{"boolean":false},"INFO":null,"STATUS":{"int":0},"REDO_VALUE":{"long":56},"UNDO_VALUE":{"long":57},"SAFE_RESUME_SCN":{"long":0},"CSCN":{"long":1447375},"OBJECT_ID":null,"EDITION_NAME":null,"CLIENT_ID":null,"SRC_CON_NAME":{"string":"CDB$ROOT"},"SRC_CON_ID":{"long":1},"SRC_CON_UID":{"long":1},"SRC_CON_DBID":{"long":0},"SRC_CON_GUID":null,"CON_ID":{"boolean":false}}
# Processed a total of 9 messages


log "Activate TRACE logs for com.wepay.kafka.connect.bigquery"
curl --request PUT \
  --url http://localhost:8083/admin/loggers/com.wepay.kafka.connect.bigquery \
  --header 'Accept: application/json' \
  --header 'Content-Type: application/json' \
  --data '{
	"level": "TRACE"
}'

log "Creating GCP BigQuery Sink connector with kafkaKeyFieldName set to ID and JsonConverter"
curl -X PUT \
     -H "Content-Type: application/json" \
     --data '{
               "connector.class": "com.wepay.kafka.connect.bigquery.BigQuerySinkConnector",
               "tasks.max" : "1",
               "value.converter": "org.apache.kafka.connect.json.JsonConverter",
               "key.converter": "org.apache.kafka.connect.json.JsonConverter",
               "kafkaKeyFieldName": "ID",
               "topics" : "ORCLCDB.C__MYUSER.CUSTOMERS.JSON",
               "sanitizeTopics" : "true",
               "autoCreateTables" : "true",
               "defaultDataset" : "'"$DATASET"'",
               "mergeIntervalMs": "5000",
               "bufferSize": "100000",
               "maxWriteSize": "10000",
               "tableWriteWait": "1000",
               "project" : "'"$PROJECT"'",
               "keyfile" : "/tmp/keyfile.json"
          }' \
     http://localhost:8083/connectors/gcp-bigquery-sink-json/config | jq .


log "Creating GCP BigQuery Sink connector with kafkaKeyFieldName set to ID and AvroConverter"
curl -X PUT \
     -H "Content-Type: application/json" \
     --data '{
               "connector.class": "com.wepay.kafka.connect.bigquery.BigQuerySinkConnector",
               "tasks.max" : "1",
               "key.converter": "io.confluent.connect.avro.AvroConverter",
               "key.converter.schema.registry.url": "http://schema-registry:8081",
               "value.converter": "io.confluent.connect.avro.AvroConverter",
               "value.converter.schema.registry.url": "http://schema-registry:8081",
               "kafkaKeyFieldName": "ID",
               "topics" : "ORCLCDB.C__MYUSER.CUSTOMERS.AVRO",
               "sanitizeTopics" : "true",
               "autoCreateTables" : "true",
               "defaultDataset" : "'"$DATASET"'",
               "mergeIntervalMs": "5000",
               "bufferSize": "100000",
               "maxWriteSize": "10000",
               "tableWriteWait": "1000",
               "project" : "'"$PROJECT"'",
               "keyfile" : "/tmp/keyfile.json"
          }' \
     http://localhost:8083/connectors/gcp-bigquery-sink-avro/config | jq .

# a workaround is to use a different name for "kafkaKeyFieldName": example "MYID"

# Key Schema:

# {
#   "fields": [
#     {
#       "name": "ID",
#       "type": "long"
#     }
#   ],
#   "name": "ConnectDefault",
#   "namespace": "io.confluent.connect.avro",
#   "type": "record"
# }

# log "Sleeping 125 seconds"
# sleep 125

# set +e
# log "Verify data is in GCP BigQuery:"
# docker run -i --volumes-from gcloud-config google/cloud-sdk:latest bq --project_id "$PROJECT" query "SELECT * FROM $DATASET.ORCLCDB_C__MYUSER_CUSTOMERS;"


wait_for_repro


# log "Drop dataset $DATASET"
# docker run -i --volumes-from gcloud-config google/cloud-sdk:latest bq --project_id "$PROJECT" rm -r -f -d "$DATASET"

# docker rm -f gcloud-config

# with JSON:

# [2021-09-13 12:10:00,695] INFO [gcp-bigquery-sink5|task-0] Attempting to create intermediate table `pgec2userds620`.`ORCLCDB_C__MYUSER_CUSTOMERS_tmp_0_b0d22c34_25de_4b43_af9f_a04a1d84ca6f_1631534996795` with schema Schema{fields=[Field{name=value, type=RECORD, mode=NULLABLE, description=null, policyTags=null}, Field{name=key, type=RECORD, mode=REQUIRED, description=null, policyTags=null}, Field{name=i, type=INTEGER, mode=REQUIRED, description=null, policyTags=null}, Field{name=partitionTime, type=TIMESTAMP, mode=NULLABLE, description=null, policyTags=null}, Field{name=batchNumber, type=INTEGER, mode=REQUIRED, description=null, policyTags=null}]} (com.wepay.kafka.connect.bigquery.SchemaManager:227)
# [2021-09-13 12:10:01,429] ERROR [gcp-bigquery-sink5|task-0] Task failed with java.lang.IllegalArgumentException error: Multiple entries with same key: ID=17 and ID=0 (com.wepay.kafka.connect.bigquery.write.batch.KCBQThreadPoolExecutor:70)
# Exception in thread "pool-18-thread-1" java.lang.IllegalArgumentException: Multiple entries with same key: ID=17 and ID=0
#         at com.google.common.collect.RegularImmutableMap.duplicateKeyException(RegularImmutableMap.java:181)
#         at com.google.common.collect.RegularImmutableMap.createHashTable(RegularImmutableMap.java:120)
#         at com.google.common.collect.RegularImmutableMap.create(RegularImmutableMap.java:81)
#         at com.google.common.collect.ImmutableMap$Builder.build(ImmutableMap.java:341)
#         at com.google.cloud.bigquery.FieldList.<init>(FieldList.java:48)
#         at com.google.cloud.bigquery.FieldList.of(FieldList.java:106)
#         at com.google.cloud.bigquery.Schema.of(Schema.java:79)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.getBigQuerySchema(SchemaManager.java:600)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.convertRecordSchema(SchemaManager.java:356)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.getAndValidateProposedSchema(SchemaManager.java:306)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.getTableInfo(SchemaManager.java:280)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.updateSchema(SchemaManager.java:252)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.createOrUpdateTable(SchemaManager.java:210)
#         at com.wepay.kafka.connect.bigquery.write.row.UpsertDeleteBigQueryWriter.attemptTableCreate(UpsertDeleteBigQueryWriter.java:87)
#         at com.wepay.kafka.connect.bigquery.write.row.AdaptiveBigQueryWriter.performWriteRequest(AdaptiveBigQueryWriter.java:115)
#         at com.wepay.kafka.connect.bigquery.write.row.BigQueryWriter.writeRows(BigQueryWriter.java:118)
#         at com.wepay.kafka.connect.bigquery.write.batch.TableWriter.run(TableWriter.java:96)
#         at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
#         at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
#         at java.base/java.lang.Thread.run(Thread.java:829)


# with AVRO:

# [2021-09-14 07:37:43,226] ERROR [gcp-bigquery-sink-avro|task-0] Task failed with java.lang.IllegalArgumentException error: Multiple entries with same key: ID=17 and ID=0 (com.wepay.kafka.connect.bigquery.write.batch.KCBQThreadPoolExecutor:70)
# [2021-09-14 07:37:43,226] DEBUG [gcp-bigquery-sink-avro|task-0] Error Task Stacktrace: (com.wepay.kafka.connect.bigquery.write.batch.KCBQThreadPoolExecutor:73)
# java.lang.IllegalArgumentException: Multiple entries with same key: ID=17 and ID=0
#         at com.google.common.collect.RegularImmutableMap.duplicateKeyException(RegularImmutableMap.java:181)
#         at com.google.common.collect.RegularImmutableMap.createHashTable(RegularImmutableMap.java:120)
#         at com.google.common.collect.RegularImmutableMap.create(RegularImmutableMap.java:81)
#         at com.google.common.collect.ImmutableMap$Builder.build(ImmutableMap.java:341)
#         at com.google.cloud.bigquery.FieldList.<init>(FieldList.java:48)
#         at com.google.cloud.bigquery.FieldList.of(FieldList.java:106)
#         at com.google.cloud.bigquery.Schema.of(Schema.java:79)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.getBigQuerySchema(SchemaManager.java:600)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.convertRecordSchema(SchemaManager.java:356)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.getAndValidateProposedSchema(SchemaManager.java:306)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.getTableInfo(SchemaManager.java:280)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.createTable(SchemaManager.java:226)
#         at com.wepay.kafka.connect.bigquery.write.row.AdaptiveBigQueryWriter.attemptTableCreate(AdaptiveBigQueryWriter.java:168)
#         at com.wepay.kafka.connect.bigquery.write.row.AdaptiveBigQueryWriter.performWriteRequest(AdaptiveBigQueryWriter.java:115)
#         at com.wepay.kafka.connect.bigquery.write.row.BigQueryWriter.writeRows(BigQueryWriter.java:118)
#         at com.wepay.kafka.connect.bigquery.write.batch.TableWriter.run(TableWriter.java:96)
#         at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
#         at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
#         at java.base/java.lang.Thread.run(Thread.java:829)
# Exception in thread "pool-11-thread-1" java.lang.IllegalArgumentException: Multiple entries with same key: ID=17 and ID=0
#         at com.google.common.collect.RegularImmutableMap.duplicateKeyException(RegularImmutableMap.java:181)
#         at com.google.common.collect.RegularImmutableMap.createHashTable(RegularImmutableMap.java:120)
#         at com.google.common.collect.RegularImmutableMap.create(RegularImmutableMap.java:81)
#         at com.google.common.collect.ImmutableMap$Builder.build(ImmutableMap.java:341)
#         at com.google.cloud.bigquery.FieldList.<init>(FieldList.java:48)
#         at com.google.cloud.bigquery.FieldList.of(FieldList.java:106)
#         at com.google.cloud.bigquery.Schema.of(Schema.java:79)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.getBigQuerySchema(SchemaManager.java:600)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.convertRecordSchema(SchemaManager.java:356)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.getAndValidateProposedSchema(SchemaManager.java:306)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.getTableInfo(SchemaManager.java:280)
#         at com.wepay.kafka.connect.bigquery.SchemaManager.createTable(SchemaManager.java:226)
#         at com.wepay.kafka.connect.bigquery.write.row.AdaptiveBigQueryWriter.attemptTableCreate(AdaptiveBigQueryWriter.java:168)
#         at com.wepay.kafka.connect.bigquery.write.row.AdaptiveBigQueryWriter.performWriteRequest(AdaptiveBigQueryWriter.java:115)
#         at com.wepay.kafka.connect.bigquery.write.row.BigQueryWriter.writeRows(BigQueryWriter.java:118)
#         at com.wepay.kafka.connect.bigquery.write.batch.TableWriter.run(TableWriter.java:96)
#         at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
#         at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
#         at java.base/java.lang.Thread.run(Thread.java:829)
